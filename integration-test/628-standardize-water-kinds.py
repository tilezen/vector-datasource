# -*- encoding: utf-8 -*-
import dsl
from shapely.wkt import loads as wkt_loads

from . import FixtureTest


class StandardizeWaterKinds(FixtureTest):
    def test_great_salt_lake_ne(self):
        # ne_10m_lakes gid 1298: Great Salt Lake, UT
        self.generate_fixtures(dsl.way(1, wkt_loads('POLYGON ((-111.9502059058227 40.97766082369037, -111.9323968761312 40.96676935098648, -111.9309250554955 40.96147079669811, -111.9340158788305 40.95646660653687, -111.9391672510552 40.95175678050279, -111.945348897725 40.94734131859578, -112.0243856658599 40.90966271032295, -112.0298314022118 40.90789652556012, -112.0497009807932 40.90701343317874, -112.0648607333405 40.90436415603457, -112.076193752235 40.89935996587334, -112.0942971460536 40.8872910366609, -112.1015090671684 40.8831699388811, -112.1203483713048 40.8761051998299, -112.1290321130552 40.86815736839739, -112.1334475749621 40.85667716743922, -112.1350665776614 40.84343078171833, -112.1352137597249 40.82047037980207, -112.1358024879792 40.81605491789507, -112.1378630368691 40.81340564075089, -112.1500791481451 40.80457471693693, -112.1839310227652 40.77396084771524, -112.2364750194582 40.74687934801915, -112.2669417066164 40.72450767435711, -112.3403855563357 40.68918397910132, -112.353190395866 40.68712343021139, -112.3668783277776 40.68888961497417, -112.3951372839822 40.69860363116953, -112.4011717485884 40.70243036482225, -112.4017604768427 40.7059627343478, -112.3949901019186 40.71302747339899, -112.3936654633466 40.71626547879742, -112.3944013736644 40.72038657657726, -112.4032322974784 40.73657660356951, -112.404704118114 40.74128642960362, -112.403673843669 40.75423845119742, -112.404704118114 40.76542428802843, -112.4061759387497 40.77160593469816, -112.4088252158938 40.77543266835087, -112.4394390851155 40.80015925502994, -112.4453263676582 40.80810708646251, -112.4472397344845 40.81546618964079, -112.4453263676582 40.85049552076946, -112.4456207317853 40.85608843918495, -112.4520967425822 40.87522210744853, -112.4543044735357 40.88640794427952, -112.4694642260829 40.91290071572139, -112.4766761471977 40.93438929700199, -112.4835937041853 40.94557513383301, -112.4899225329186 40.94439767732446, -112.5002252773682 40.92820765033224, -112.5052294675295 40.92290909604387, -112.5156793940426 40.91496126461129, -112.5200948559496 40.90936834619581, -112.5231856792845 40.9020092430175, -112.5312806927806 40.85991517283769, -112.5339299699248 40.85432225442217, -112.5426137116752 40.84401950997257, -112.5473235377093 40.83489422203148, -112.5539467305697 40.82930130361601, -112.5624832902566 40.83165621663306, -112.5702839396255 40.83813222742995, -112.5908894285248 40.87463337919427, -112.5954520724953 40.88022629760979, -112.6029583577372 40.88552485189814, -112.6284208547341 40.89788814523768, -112.6343081372767 40.90436415603457, -112.6373989606115 40.91172325921285, -112.6368102323573 40.91819927000977, -112.6303342215604 40.93115129160355, -112.6290095829883 40.93703857414618, -112.6306285856875 40.94057094367177, -112.6354855937852 40.94086530779889, -112.6506453463325 40.93762730240044, -112.6591819060193 40.93939348716322, -112.6649220064984 40.94263149256169, -112.6672769195154 40.94586949796012, -112.6690431042782 40.94940186748569, -112.6728698379309 40.95411169351978, -112.684055674762 40.96529753035082, -112.692150688258 40.97030172051208, -112.7152582722379 40.97972137258028, -112.7435172284426 40.99650012782677, -112.7517594240022 41.00444795925935, -112.7507291495573 41.01239579069186, -112.7373355817728 41.02740836117561, -112.73556939701 41.03241255133684, -112.7413094974891 41.03417873609965, -112.7658889021045 41.03623928498955, -112.7756029182999 41.04006601864226, -112.7776634671898 41.04536457293062, -112.7742782797278 41.04919130658335, -112.7672135406767 41.04978003483761, -112.7605903478161 41.04948567071047, -112.7570579782906 41.05125185547328, -112.7561748859092 41.05448986087173, -112.7585297989262 41.06214332817715, -112.7592657092441 41.06655879008412, -112.7583826168627 41.07833335516939, -112.760295983689 41.08480936596629, -112.7692740895666 41.0959952027973, -112.7695684536937 41.10188248533991, -112.7673607227402 41.10747540375543, -112.7667719944859 41.11218522978952, -112.768096633058 41.11718941995075, -112.7764860106813 41.13102453392596, -112.7788409236983 41.13632308821433, -112.7798711981433 41.14221037075698, -112.7810486546518 41.15957785425773, -112.7798711981433 41.16752568569027, -112.7773691030627 41.17488478886857, -112.7733951873464 41.182538256174, -112.7720705487743 41.19048608760656, -112.7763388286177 41.19784519078484, -112.7839922959231 41.20461556570888, -112.8179913526069 41.22816469587943, -112.8229955427681 41.23464070667629, -112.8366834746797 41.26348839113517, -112.8431594854766 41.27055313018636, -112.8940844794704 41.3005782711538, -112.9039456777293 41.31029228734913, -112.9161617890053 41.3264823143414, -112.9232265280564 41.32707104259566, -112.9722381552239 41.30322754829799, -112.9742987041138 41.29792899400961, -112.9723853372874 41.29027552670419, -112.9682642395076 41.27938405400032, -112.9687057856983 41.2708474943135, -112.9768007991944 41.26937567367784, -113.0072674863525 41.27496859209334, -113.0125660406409 41.27761786923752, -113.0158040460393 41.2817389670174, -113.0166871384207 41.28674315717863, -113.0150681357215 41.29351353210262, -113.001674567937 41.31912321116307, -112.9965231957122 41.32618795021425, -112.9884281822161 41.33030904799408, -112.9779782557029 41.33119214037549, -112.9547234896595 41.32765977084989, -112.9475115685448 41.32913159148558, -112.943390470765 41.33148650450263, -112.9422130142564 41.33295832513829, -112.9520742125153 41.38123404198786, -112.9785669839572 41.42921539471034, -112.9968175598393 41.45453070964363, -113.0215441465184 41.5116373503072, -113.0236046954083 41.52282318713817, -113.0177174128657 41.52547246428237, -113.001674567937 41.52135136650255, -112.9994668369835 41.52341191539247, -112.9999083831742 41.52900483380799, -112.9993196549199 41.53430338809637, -112.9943154647587 41.53636393698626, -112.9862204512626 41.5369526652405, -112.9798916225293 41.53989630651184, -112.9770951633215 41.54460613254596, -112.9820993534828 41.55490887699553, -112.9806275328471 41.55932433890253, -112.9784198018936 41.56315107255524, -112.9781254377665 41.56756653446224, -112.9813634431649 41.57198199636917, -112.9873979077711 41.57639745827618, -112.9957872853944 41.58051855605603, -113.0163927742936 41.58699456685292, -113.0221328747727 41.59170439288702, -113.0246349698533 41.59759167542965, -113.0253708801711 41.60465641448081, -113.0212497823913 41.61083806115058, -113.0112414020688 41.61495915893043, -112.9985837446021 41.61643097956603, -112.9770951633215 41.61613661543894, -112.9470700223541 41.62820554465137, -112.9372088240952 41.63056045766838, -112.930144085044 41.63114918592265, -112.9148371504332 41.62820554465137, -112.9018851288394 41.62820554465137, -112.8577305097696 41.63556464782964, -112.8502242245278 41.63909701735521, -112.8391855697603 41.65204903894903, -112.8316792845185 41.65558140847456, -112.8254976378487 41.65764195736453, -112.8235842710223 41.66117432689008, -112.8235842710223 41.66558978879706, -112.8229955427681 41.67059397895829, -112.8187272629247 41.674420712611, -112.8109266135557 41.67706998975522, -112.7801655622704 41.68030799515368, -112.7745726438549 41.68148545166216, -112.7601488016255 41.67854181039083, -112.7520537881293 41.67559816911955, -112.7285046579588 41.66235178339861, -112.7276215655774 41.66146869101723, -112.7261497449418 41.65793632149166, -112.7236476498611 41.65381522371176, -112.7207040085898 41.65116594656762, -112.7021590685805 41.63821392497383, -112.6999513376271 41.63468155544825, -112.7018647044534 41.6179028002017, -112.7023062506441 41.61701970782032, -112.7030421609619 41.61643097956603, -112.7081935331867 41.59965222431958, -112.7076048049325 41.58846638748857, -112.7080463511231 41.58140164843741, -112.711137174458 41.57728055065756, -112.7273272014503 41.56373980080947, -112.7395433127263 41.55814688239401, -112.7435172284426 41.55255396397849, -112.7454305952689 41.54578358905447, -112.7454305952689 41.5404850347661, -112.7435172284426 41.53548084460486, -112.7326257557387 41.52194009475679, -112.7301236606581 41.51723026872272, -112.7274743835138 41.50898807316301, -112.7236476498611 41.50192333411185, -112.7182019135092 41.49897969284055, -112.7123146309666 41.49721350807773, -112.7062801663604 41.49426986680644, -112.7005400658813 41.48838258426379, -112.6827310361898 41.46453908996613, -112.6769909357108 41.4583574432964, -112.6477017050612 41.43981250328702, -112.6373989606115 41.43480831312583, -112.6107590071061 41.42597738931188, -112.5973654393216 41.42391684042195, -112.5885345155077 41.42627175343903, -112.58367750741 41.43068721534599, -112.5822056867744 41.43598576963438, -112.5805866840752 41.43863504677856, -112.5764655862953 41.43892941090571, -112.5660156597822 41.43716322614291, -112.5517389996162 41.43657449788861, -112.5415834372302 41.43392522074442, -112.5299560542085 41.42833230232895, -112.5208307662674 41.42273938391344, -112.5161209402333 41.41861828613358, -112.5136188451527 41.41390846009948, -112.5080259267372 41.38918187342043, -112.506406924038 41.36121728134292, -112.5028745545124 41.34561598260495, -112.4958098154612 41.33825687942667, -112.4803556987868 41.33295832513829, -112.4757930548163 41.3285428632313, -112.4731437776721 41.32294994481576, -112.4725550494178 41.31676829814604, -112.4741740521171 41.31058665147627, -112.4793254243419 41.3005782711538, -112.4809444270411 41.2961628092468, -112.4815331552954 41.29056989083134, -112.4815331552954 41.27644041272898, -112.4800613346597 41.26908130955071, -112.4734381417992 41.25642365208407, -112.4722606852907 41.25112509779566, -112.4716719570364 41.23846744032903, -112.4678452233837 41.23081397302359, -112.4597502098876 41.22374923397243, -112.4394390851155 41.21109157650575, -112.4297250689202 41.20667611459878, -112.4200110527248 41.20549865809028, -112.4120632212923 41.20726484285306, -112.4072062131946 41.21109157650575, -112.4027907512876 41.21550703841275, -112.3970506508085 41.21845067968408, -112.3462728388783 41.23228579365926, -112.3462728388783 41.26702076066078, -112.3611382272985 41.27437986383906, -112.373501520638 41.29998954289954, -112.3827739906427 41.33089777624836, -112.3860119960411 41.33560760228246, -112.3960203763636 41.34267234133361, -112.3995527458892 41.34826525974913, -112.3980809252535 41.35444690641889, -112.393518281283 41.36033418896152, -112.3873366346132 41.36504401499563, -112.3833627188969 41.36887074864836, -112.3830683547698 41.37328621055532, -112.3839514471512 41.37887912897082, -112.3835099009605 41.38623823214909, -112.384687357469 41.39300860707313, -112.3902802758845 41.39742406898007, -112.3973450149357 41.40095643850569, -112.4033794795419 41.40478317215841, -112.4064703028768 41.40949299819252, -112.4072062131946 41.41538028073516, -112.4007302023977 41.4474659705925, -112.3973450149357 41.45423634551649, -112.3914577323931 41.45747435091499, -112.361285409362 41.4624785410762, -112.3561340371373 41.46188981282196, -112.3537791241202 41.45806307916923, -112.3496580263404 41.45305888900803, -112.3415630128442 41.44923215535529, -112.3327320890303 41.44776033471965, -112.326403260297 41.4495265194824, -112.3196328853729 41.45629689440644, -112.3162476979109 41.45865180742349, -112.3127153283854 41.4595348998049, -112.3090357767962 41.45924053567776, -112.3050618610799 41.45806307916923, -112.2848979183714 41.44776033471965, -112.2787162717016 41.44246178043127, -112.2706212582055 41.43215903598166, -112.2690022555063 41.42303374804054, -112.2776859972567 41.42067883502349, -112.2887246520241 41.42097319915065, -112.294170388376 41.4197957426421, -112.2925513856768 41.41567464486229, -112.2847507363078 41.40390007977703, -112.2818070950365 41.39477479183594, -112.2770972690024 41.38771005278475, -112.2690022555063 41.3850607756406, -112.2604656958195 41.38564950389485, -112.2501629513698 41.38888750929328, -112.2445700329543 41.38888750929328, -112.2380940221574 41.3871213245305, -112.2308821010427 41.38358895500494, -112.2221983592924 41.38241149849643, -112.2001210497575 41.38859314516616, -112.1786324684768 41.38888750929328, -112.1702430908536 41.39389169945454, -112.1539058817978 41.40860990581111, -112.1428672270304 41.41243663946382, -112.0657438257219 41.40978736231967, -112.0560298095265 41.39330297120027, -112.0516143476195 41.38035094960648, -112.0545579888908 41.37122566166542, -112.0981238797063 41.33649069466385, -112.1265300179746 41.34149488482509, -112.1327116646443 41.35297508578323, -112.1366855803606 41.35297508578323, -112.1503735122722 41.33089777624836, -112.1543474279885 41.32824849910418, -112.1614121670397 41.32795413497706, -112.1731867321249 41.33119214037549, -112.2035062372195 41.3453216184778, -112.2532537747047 41.34767653149487, -112.2916682932954 41.31912321116307, -112.3252258037884 41.2708474943135, -112.2991745785373 41.26466584764375, -112.2569333262939 41.26466584764375, -112.2532537747047 41.24347163049023, -112.2510460437512 41.23670125556622, -112.2466305818443 41.23140270127785, -112.202328780711 41.20108319618329, -112.1939394030877 41.19254663649646, -112.1899654873714 41.18194952791973, -112.1849612972102 41.15898912600343, -112.178926832604 41.14927510980811, -112.1696543625994 41.14162164250268, -112.1489016916365 41.13161326218022, -112.1405123140133 41.12602034376472, -112.1340363032164 41.11718941995075, -112.1293264771823 41.10570921899262, -112.1265300179746 41.09334592565309, -112.1224089201947 41.08245445294921, -112.108426624156 41.0683249748469, -112.1043055263761 41.06096587166864, -112.0972407873249 41.05478422499883, -112.0595621790521 41.04860257832911, -112.0098146415668 41.03241255133684, -111.997892894418 41.02623090466709, -111.9853824190149 41.01769434498026, -111.9663959328149 41.00150431798802, -111.9566819166196 40.98560865512289, -111.9502059058227 40.97766082369037), (-112.5328996954798 41.0062141440221, -112.519947673886 41.01445633958182, -112.5200948559496 41.01887180148879, -112.5237744075388 41.02505344815856, -112.5264236846829 41.03152945895544, -112.5293673259543 41.03594492086241, -112.5337827878612 41.03623928498955, -112.5471763556457 41.03152945895544, -112.5548298229511 41.03005763831978, -112.5552713691418 41.01798870910741, -112.5542410946969 41.01004087767482, -112.551150271362 41.0062141440221, -112.546734809455 41.00238741036942, -112.5429080758023 40.99473394306398, -112.5398172524674 40.99061284528413, -112.5328996954798 41.0062141440221), (-112.314187149021 41.13838363710423, -112.3119794180675 41.14191600662983, -112.3133040566396 41.15339620758796, -112.3147758772753 41.15869476187633, -112.3203687956908 41.16399331616471, -112.3216934342629 41.16988059870734, -112.3314074504582 41.1760622453771, -112.3431820155435 41.18665935395383, -112.3490692980861 41.18901426697089, -112.3579002219001 41.18901426697089, -112.3768867081001 41.18548189744531, -112.3836570830241 41.182538256174, -112.3876309987403 41.17871152252129, -112.388072544931 41.17576788124997, -112.3839514471512 41.17400169648717, -112.3683501484132 41.17341296823291, -112.35996077079 41.16929187045308, -112.3505411187218 41.16075531076626, -112.3386193715729 41.15633984885929, -112.3174251544195 41.1389723653585, -112.314187149021 41.13838363710423), (-112.1665635392645 40.91731617762837, -112.1689184522815 40.93144565573069, -112.1618537132304 40.95528915002836, -112.165680446883 40.97589463892757, -112.1717149114893 40.98708047575857, -112.1873162102272 41.00474232338647, -112.1920260362613 41.01445633958182, -112.1937922210242 41.02475908403142, -112.1909957618164 41.02858581768413, -112.19114294388 41.03506182848103, -112.1937922210242 41.04330402404074, -112.2024759627745 41.05655040976162, -112.2071857888086 41.06037714341436, -112.2227870875466 41.06597006182985, -112.234856016759 41.0748009856438, -112.2388299324753 41.07538971389809, -112.2478080383528 41.07391789326242, -112.2526650464505 41.07126861611823, -112.2485439486707 41.06332078468566, -112.2503101334334 41.05831659452438, -112.2554615056582 41.05655040976162, -112.2688550734427 41.05478422499883, -112.2712099864598 41.05184058372752, -112.2654698859807 41.03947729038802, -112.249427041052 41.03800546975236, -112.2448643970815 41.0365336491167, -112.2388299324753 41.03005763831978, -112.2364750194582 41.02210980688723, -112.2388299324753 41.01592816021743, -112.2481024024799 41.0062141440221, -112.2489854948613 41.0017986821151, -112.247072128035 40.99326212242831, -112.2498685872427 40.98089882908881, -112.2481024024799 40.9650031662237, -112.2439813047001 40.95734969891826, -112.2005625959482 40.90377542778032, -112.1896711232443 40.88552485189814, -112.1770134657777 40.87316155855861, -112.1727451859342 40.87492774332141, -112.1720092756164 40.87993193348262, -112.1746585527606 40.88964594967799, -112.1668579033916 40.90789652556012, -112.1665635392645 40.91731617762837))'), {u'note': u'', u'scalerank': 1, u'admin': u'', u'delta': u'', u'name_alt': u'', u'dam_name': u'', u'source': u'naturalearthdata.com', u'year': -99, u'featurecla': u'Alkaline Lake', u'name_abb': u'Great Salt L.', u'name': u'Great Salt Lake', u'min_zoom': 1.7}))

        self.assert_has_feature(
            7, 23, 47, 'water',
            {'kind': 'lake', 'alkaline': True})

    def test_reservoir(self):
        # Francisco Reservoir, SF
        self.generate_fixtures(dsl.way(386662458, wkt_loads('POLYGON ((-122.421611012467 37.80395991667648, -122.420227786592 37.80413210674329, -122.420159873957 37.80408277780808, -122.420117832801 37.80383748120349, -122.42154480663 37.80365748294528, -122.421611012467 37.80395991667648))'), {u'way_area': u'6936.45', u'source': u'openstreetmap.org', u'landuse': u'reservoir', u'name': u'Francisco Reservoir', u'covered': u'no'}))

        self.assert_has_feature(
            16, 10481, 25324, 'water',
            {'kind': 'lake', 'reservoir': True})
