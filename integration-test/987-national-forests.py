# -*- encoding: utf-8 -*-
from shapely.wkt import loads as wkt_loads
import dsl
from . import FixtureTest


class NationalForests(FixtureTest):
    def test_boundary_national_park(self):
        # Example Stanislaus National Forest in California near Yosemite
        # should be kind:forest.
        self.generate_fixtures(dsl.way(-972008, wkt_loads('LINESTRING (-120.234375 38.26614467866047, -120.230630275293 38.26606967382079, -120.226055964035 38.26597805448839, -120.221435928529 38.26586781490759, -120.221488390141 38.26223157824209, -120.219906726421 38.26218770586568, -120.219791292907 38.26229858583989, -120.219236493387 38.26256809682748, -120.218813566551 38.26268997951049, -120.218449479367 38.26279500441309, -120.217789487128 38.26295095447519, -120.217134166128 38.2629848106181, -120.216806101386 38.2629508134079, -120.216596883756 38.26292930064219, -120.216566969857 38.26292605609331, -120.216513969256 38.26292069553408, -120.215865116126 38.2627825904634, -120.215253363417 38.26249791544437, -120.214787946269 38.26208698268889, -120.21199858748 38.26203528089199, -120.211669714255 38.25848420339777, -120.213577466423 38.25844018768228, -120.215904911493 38.25667445833668, -120.215948479784 38.2548617054574, -120.218258407706 38.25306640208217, -120.218295418296 38.25127168925889, -120.223947079074 38.24773490088638, -120.226209126791 38.24777377305482, -120.234375 38.24145978770348)'), {u'website': u'http://www.fs.usda.gov/stanislaus', u'attribution': u'USDA-Forest Service, Pacific Southwest Region', u'name': u'Stanislaus National Forest', u'boundary:type': u'protected_area', u'wikipedia': u'en:Stanislaus National Forest', u'name:de': u'Nationalforst Stanislaus', u'source': u'openstreetmap.org', u'protected': u'perpetuity', u'wikidata': u'Q2898163', u'ownership': u'national', u'operator': u'United States Forest Service', u'boundary': u'national_park', u'protection_title': u'National Forest', u'protect_class': u'6'}),dsl.way(38224481, wkt_loads('POLYGON ((-120.234375 38.26614467866047, -120.230630275293 38.26606967382079, -120.226055964035 38.26597805448839, -120.221435928529 38.26586781490759, -120.221488390141 38.26223157824209, -120.219906726421 38.26218770586568, -120.219791292907 38.26229858583989, -120.219236493387 38.26256809682748, -120.218813566551 38.26268997951049, -120.218449479367 38.26279500441309, -120.217789487128 38.26295095447519, -120.217134166128 38.2629848106181, -120.216806101386 38.2629508134079, -120.216596883756 38.26292930064219, -120.216566969857 38.26292605609331, -120.216513969256 38.26292069553408, -120.215865116126 38.2627825904634, -120.215253363417 38.26249791544437, -120.214787946269 38.26208698268889, -120.21199858748 38.26203528089199, -120.211669714255 38.25848420339777, -120.213577466423 38.25844018768228, -120.215904911493 38.25667445833668, -120.215948479784 38.2548617054574, -120.218258407706 38.25306640208217, -120.218295418296 38.25127168925889, -120.223947079074 38.24773490088638, -120.226209126791 38.24777377305482, -120.234375 38.24145978770348, -120.234375 38.26614467866047))'), {u'csp:globalid': u'{2FE941CA-B5A9-4D4A-83B0-62BCC7B039E9}', u'attribution': u'CASIL CSP_Opbdys072008', u'name': u'Calaveras Big Trees State Park', u'way_area': u'4.26303e+07', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'boundary': u'protected_area', u'park:type': u'state_park', u'csp:unitcode': u'306'}),dsl.way(-972008, wkt_loads('POLYGON ((-120.234375 38.24145978770348, -120.226209126791 38.24777377305482, -120.223947079074 38.24773490088638, -120.218295418296 38.25127168925889, -120.218258407706 38.25306640208217, -120.215948479784 38.2548617054574, -120.215904911493 38.25667445833668, -120.213577466423 38.25844018768228, -120.211669714255 38.25848420339777, -120.21199858748 38.26203528089199, -120.214787946269 38.26208698268889, -120.215253363417 38.26249791544437, -120.215865116126 38.2627825904634, -120.216513969256 38.26292069553408, -120.216566969857 38.26292605609331, -120.216596883756 38.26292930064219, -120.216806101386 38.2629508134079, -120.217134166128 38.2629848106181, -120.217789487128 38.26295095447519, -120.218449479367 38.26279500441309, -120.218813566551 38.26268997951049, -120.219236493387 38.26256809682748, -120.219791292907 38.26229858583989, -120.219906726421 38.26218770586568, -120.221488390141 38.26223157824209, -120.221435928529 38.26586781490759, -120.226055964035 38.26597805448839, -120.230630275293 38.26606967382079, -120.234375 38.26614467866047, -120.234375 38.27268853598096, -120.05859375 38.27268853598096, -120.05859375 38.13455657705413, -120.234375 38.13455657705413, -120.234375 38.24145978770348))'), {u'website': u'http://www.fs.usda.gov/stanislaus', u'attribution': u'USDA-Forest Service, Pacific Southwest Region', u'name': u'Stanislaus National Forest', u'boundary:type': u'protected_area', u'way_area': u'5.64855e+09', u'wikipedia': u'en:Stanislaus National Forest', u'name:de': u'Nationalforst Stanislaus', u'source': u'openstreetmap.org', u'protected': u'perpetuity', u'wikidata': u'Q2898163', u'ownership': u'national', u'operator': u'United States Forest Service', u'boundary': u'national_park', u'protection_title': u'National Forest', u'protect_class': u'6'}))  # noqa

        self.assert_has_feature(
            11, 340, 788, 'landuse',
            {'kind': 'forest', 'id': -972008})

    def test_protect_class_5(self):
        # But this other Humboldt forest in Nevada has protect_class 5 so
        # that's not guaranteed, should be kind:forest.
        self.generate_fixtures(dsl.way(398537813, wkt_loads('LINESTRING (-115.0627732652316 40.84706035607121, -115.062502790158 40.84680371819759, -115.062223503936 40.84649269177549, -115.061939995632 40.8461726938739, -115.061754224032 40.84603440591869, -115.061244699603 40.8460168735676, -115.06095418444 40.84601198081771, -115.060497660612 40.84600430191768, -115.060142826075 40.8459712758422, -115.059787362717 40.84595625780648, -115.059340001706 40.84584066638649, -115.059031969395 40.8458264637818, -115.058817272042 40.84586791635142, -115.058674260249 40.84589251606071, -115.058489566626 40.84571827924869, -115.058340446289 40.8455445856213, -115.058370360188 40.84532889501368, -115.058434499899 40.8451679080882, -115.058558826735 40.84497178756539, -115.058716121741 40.84486638783459, -115.058751605195 40.8444615724813, -115.05876076801 40.84414645766019, -115.058753222162 40.84400218526779, -115.058609581548 40.8440448622023, -115.058267862414 40.84396698357189, -115.058137966024 40.8439468003517, -115.057910332931 40.8440240673937, -115.057532321859 40.84397269195628, -115.056908441895 40.8438089834515, -115.056323458982 40.84352886360258, -115.056180267525 40.84343188830869, -115.055881667525 40.84322420983679, -115.055505093758 40.84281700591787, -115.055456225406 40.84276671687579, -115.055165261086 40.84257256004061, -115.054904031001 40.842180914683, -115.05478698052 40.84171947288328, -115.054721134009 40.84153815731759, -115.054575696765 40.84123845546367, -115.05444319526 40.84130831805779, -115.054294074923 40.84153999222278, -115.054034282143 40.8419050014158, -115.053677111986 40.84235828689118, -115.053468433346 40.8425979764735, -115.05329532799 40.84243290540238, -115.052895128531 40.8423270938821, -115.0524271961 40.84210296590347, -115.052045501935 40.8417722772108, -115.051599039239 40.84122431983258, -115.051450907049 40.84101459564378, -115.051408596399 40.84099142128407, -115.051322627626 40.8409403832962, -115.051166141104 40.84101880916288, -115.051171890322 40.84082070551668, -115.051322627626 40.84053500027879, -115.051409045557 40.8404193994033, -115.051581881417 40.8401880611257, -115.051585025521 40.8400800712714, -115.051409943872 40.83991037257348, -115.05107774688 40.83958510985799, -115.050947311501 40.83917747581019, -115.050950725099 40.83913697052279, -115.050980998324 40.83883576264288, -115.051107481116 40.83856771910059, -115.051134879732 40.83844198836369, -115.050822176182 40.83818447747779, -115.050583763305 40.83782019539218, -115.050546932379 40.8374593094865, -115.050652304761 40.83710066442808, -115.050707371488 40.83684036179669, -115.050698388335 40.83674120185699, -115.050293787131 40.83638309663147, -115.050017195855 40.83610811074021, -115.049999319381 40.83590972055671, -115.050129485266 40.83551552110238, -115.050166585687 40.8354621000995, -115.050204045435 40.8353997075759, -115.050315975519 40.83522136522378, -115.050377420284 40.8351504087583, -115.050403740922 40.83506076154428, -115.05017673665 40.83471460933688, -115.049800791704 40.83418576030878, -115.049653018839 40.83356182041859, -115.049676195374 40.83317481161448, -115.049776627022 40.83298735553689, -115.049742131715 40.83254535674809, -115.049838341282 40.83209669403828, -115.049939222089 40.83189115507029, -115.050120232619 40.83178621032507, -115.050138737913 40.8314306611873, -115.050147271909 40.8312642029066, -115.050264771548 40.83089675615759, -115.050390176361 40.83066470494188, -115.050512167577 40.83054969859018, -115.050600921127 40.8303529910465, -115.050747885508 40.83019339513989, -115.050705844352 40.83001245587489, -115.050488002896 40.82975661153348, -115.050376611801 40.8295115057471, -115.050427905603 40.82937726134529, -115.050427366614 40.82898988825418, -115.050508304821 40.82865797860999, -115.05050587937 40.8283336802794, -115.050464646698 40.82812581855769, -115.050610982258 40.82780851889798, -115.050667216795 40.82768786577989, -115.050916858613 40.82725969837909, -115.05112068635 40.8271820719247, -115.051428359335 40.82707915895449, -115.051587720467 40.8270277703839, -115.052258941647 40.82678686893439, -115.052737743693 40.82663290634758, -115.053282122756 40.82666906889459, -115.053482267401 40.82671746685887, -115.053697503743 40.82665805699329, -115.053967986475 40.82673466444169, -115.054134534129 40.82671950609819, -115.054300183467 40.82673126571028, -115.054421276367 40.8266433064806, -115.054213765537 40.82644155720399, -115.05348810645 40.82611412117209, -115.052856231479 40.8258242060431, -115.052261816256 40.82547188778059, -115.051985494475 40.8251878837747, -115.051900424017 40.82485316806188, -115.051923331057 40.82447528531531, -115.052048735871 40.8242432116277, -115.052109641647 40.8241901894058, -115.052340778169 40.82398686918519, -115.052357666497 40.8238159736731, -115.052351647784 40.82361781861989, -115.052331615353 40.82349131177378, -115.052055563067 40.82319839413609, -115.051896830756 40.82295251634558, -115.051892608674 40.82269120646438, -115.052041369685 40.82246850763648, -115.052072720889 40.82220780766171, -115.051974175702 40.8219269167376, -115.051873294896 40.82172705654647, -115.051786158313 40.82146438223661, -115.051943543151 40.82057071076191, -115.056219613735 40.8205707787428, -115.060978079626 40.82056989499048, -115.065735916697 40.82056867133348, -115.070512169231 40.8205722063426, -115.075289140417 40.8205754014469, -115.080065392952 40.8205784605891, -115.084841735317 40.8205767610657, -115.084845598073 40.82420256126139, -115.084848742177 40.8278282991911, -115.084852604932 40.83145397482899, -115.084855659204 40.83507965611499, -115.084858982971 40.83870078953419, -115.084860869433 40.8423175117129, -115.084862576232 40.8444973855223, -115.085839583935 40.84542790619579, -115.086115636222 40.84572976367049, -115.086304731589 40.84593559950759, -115.086403186944 40.84604079367339, -115.086555990374 40.8465026810671, -115.086568027799 40.8469082993999, -115.0865936220718 40.84706035607121)'), {u'source': u'openstreetmap.org', u'boundary': u'protected_area', u'attribution': u'US Forest Service'}),dsl.way(398539736, wkt_loads('MULTILINESTRING ((-115.0466345291559 40.84706035607121, -115.046701334479 40.82798681321668, -115.047156061676 40.81316690083191, -115.046253883636 40.7995988781762, -115.055962336237 40.79959629408368, -115.055704879077 40.79235867225399, -115.065743462545 40.79236112060858, -115.065747325301 40.77780120048339, -115.06500432873 40.7778007923348, -115.064992920126 40.7559924892667, -115.045945222504 40.75604971684229, -115.045902732191 40.73433535915499, -115.055432060725 40.7343026859072, -115.055408884191 40.72705971999079, -115.064946297562 40.72702166510858, -115.064927073615 40.71979771914559, -115.083996779961 40.71970580551879, -115.0839839903945 40.71395582628604), (-115.1221518893897 40.71395582628604, -115.122333103363 40.76309261947759, -115.122264382244 40.77772929827339, -115.113431787044 40.7777427671891, -115.113442387165 40.7989159942235, -115.122979710705 40.79891402213259, -115.122979710705 40.7990987183914, -115.13671875 40.79907957220557))'), {u'source': u'openstreetmap.org', u'boundary': u'national_park', u'attribution': u'US Forest Service'}),dsl.way(-2389847, wkt_loads('LINESTRING (-115.0627732652316 40.84706035607121, -115.062502790158 40.84680371819759, -115.062223503936 40.84649269177549, -115.061939995632 40.8461726938739, -115.061754224032 40.84603440591869, -115.061244699603 40.8460168735676, -115.06095418444 40.84601198081771, -115.060497660612 40.84600430191768, -115.060142826075 40.8459712758422, -115.059787362717 40.84595625780648, -115.059340001706 40.84584066638649, -115.059031969395 40.8458264637818, -115.058817272042 40.84586791635142, -115.058674260249 40.84589251606071, -115.058489566626 40.84571827924869, -115.058340446289 40.8455445856213, -115.058370360188 40.84532889501368, -115.058434499899 40.8451679080882, -115.058558826735 40.84497178756539, -115.058716121741 40.84486638783459, -115.058751605195 40.8444615724813, -115.05876076801 40.84414645766019, -115.058753222162 40.84400218526779, -115.058609581548 40.8440448622023, -115.058267862414 40.84396698357189, -115.058137966024 40.8439468003517, -115.057910332931 40.8440240673937, -115.057532321859 40.84397269195628, -115.056908441895 40.8438089834515, -115.056323458982 40.84352886360258, -115.056180267525 40.84343188830869, -115.055881667525 40.84322420983679, -115.055505093758 40.84281700591787, -115.055456225406 40.84276671687579, -115.055165261086 40.84257256004061, -115.054904031001 40.842180914683, -115.05478698052 40.84171947288328, -115.054721134009 40.84153815731759, -115.054575696765 40.84123845546367, -115.05444319526 40.84130831805779, -115.054294074923 40.84153999222278, -115.054034282143 40.8419050014158, -115.053677111986 40.84235828689118, -115.053468433346 40.8425979764735, -115.05329532799 40.84243290540238, -115.052895128531 40.8423270938821, -115.0524271961 40.84210296590347, -115.052045501935 40.8417722772108, -115.051599039239 40.84122431983258, -115.051450907049 40.84101459564378, -115.051408596399 40.84099142128407, -115.051322627626 40.8409403832962, -115.051166141104 40.84101880916288, -115.051171890322 40.84082070551668, -115.051322627626 40.84053500027879, -115.051409045557 40.8404193994033, -115.051581881417 40.8401880611257, -115.051585025521 40.8400800712714, -115.051409943872 40.83991037257348, -115.05107774688 40.83958510985799, -115.050947311501 40.83917747581019, -115.050950725099 40.83913697052279, -115.050980998324 40.83883576264288, -115.051107481116 40.83856771910059, -115.051134879732 40.83844198836369, -115.050822176182 40.83818447747779, -115.050583763305 40.83782019539218, -115.050546932379 40.8374593094865, -115.050652304761 40.83710066442808, -115.050707371488 40.83684036179669, -115.050698388335 40.83674120185699, -115.050293787131 40.83638309663147, -115.050017195855 40.83610811074021, -115.049999319381 40.83590972055671, -115.050129485266 40.83551552110238, -115.050166585687 40.8354621000995, -115.050204045435 40.8353997075759, -115.050315975519 40.83522136522378, -115.050377420284 40.8351504087583, -115.050403740922 40.83506076154428, -115.05017673665 40.83471460933688, -115.049800791704 40.83418576030878, -115.049653018839 40.83356182041859, -115.049676195374 40.83317481161448, -115.049776627022 40.83298735553689, -115.049742131715 40.83254535674809, -115.049838341282 40.83209669403828, -115.049939222089 40.83189115507029, -115.050120232619 40.83178621032507, -115.050138737913 40.8314306611873, -115.050147271909 40.8312642029066, -115.050264771548 40.83089675615759, -115.050390176361 40.83066470494188, -115.050512167577 40.83054969859018, -115.050600921127 40.8303529910465, -115.050747885508 40.83019339513989, -115.050705844352 40.83001245587489, -115.050488002896 40.82975661153348, -115.050376611801 40.8295115057471, -115.050427905603 40.82937726134529, -115.050427366614 40.82898988825418, -115.050508304821 40.82865797860999, -115.05050587937 40.8283336802794, -115.050464646698 40.82812581855769, -115.050610982258 40.82780851889798, -115.050667216795 40.82768786577989, -115.050916858613 40.82725969837909, -115.05112068635 40.8271820719247, -115.051428359335 40.82707915895449, -115.051587720467 40.8270277703839, -115.052258941647 40.82678686893439, -115.052737743693 40.82663290634758, -115.053282122756 40.82666906889459, -115.053482267401 40.82671746685887, -115.053697503743 40.82665805699329, -115.053967986475 40.82673466444169, -115.054134534129 40.82671950609819, -115.054300183467 40.82673126571028, -115.054421276367 40.8266433064806, -115.054213765537 40.82644155720399, -115.05348810645 40.82611412117209, -115.052856231479 40.8258242060431, -115.052261816256 40.82547188778059, -115.051985494475 40.8251878837747, -115.051900424017 40.82485316806188, -115.051923331057 40.82447528531531, -115.052048735871 40.8242432116277, -115.052109641647 40.8241901894058, -115.052340778169 40.82398686918519, -115.052357666497 40.8238159736731, -115.052351647784 40.82361781861989, -115.052331615353 40.82349131177378, -115.052055563067 40.82319839413609, -115.051896830756 40.82295251634558, -115.051892608674 40.82269120646438, -115.052041369685 40.82246850763648, -115.052072720889 40.82220780766171, -115.051974175702 40.8219269167376, -115.051873294896 40.82172705654647, -115.051786158313 40.82146438223661, -115.051943543151 40.82057071076191, -115.056219613735 40.8205707787428, -115.060978079626 40.82056989499048, -115.065735916697 40.82056867133348, -115.070512169231 40.8205722063426, -115.075289140417 40.8205754014469, -115.080065392952 40.8205784605891, -115.084841735317 40.8205767610657, -115.084845598073 40.82420256126139, -115.084848742177 40.8278282991911, -115.084852604932 40.83145397482899, -115.084855659204 40.83507965611499, -115.084858982971 40.83870078953419, -115.084860869433 40.8423175117129, -115.084862576232 40.8444973855223, -115.085839583935 40.84542790619579, -115.086115636222 40.84572976367049, -115.086304731589 40.84593559950759, -115.086403186944 40.84604079367339, -115.086555990374 40.8465026810671, -115.086568027799 40.8469082993999, -115.0865936220718 40.84706035607121)'), {u'website': u'http://www.fs.usda.gov/htnf', u'name': u'Humboldt-Toiyabe National Forest', u'boundary:type': u'protected_area', u'wikipedia': u'en:Humboldt-Toiyabe National Forest', u'name:de': u'Nationalforst Humboldt-Toiyabe', u'source': u'openstreetmap.org', u'name:fr': u"For\xeat nationale d'Humboldt-Toiyabe", u'protected': u'perpetuity', u'wikidata': u'Q5940240', u'protection_title': u'National Forest', u'ownership': u'national', u'operator': u'United States Forest Service', u'boundary': u'national_park', u'name:es': u'Bosque Nacional Humboldt-Toiyabe', u'protect_class': u'5'}),dsl.way(-2389847, wkt_loads('MULTILINESTRING ((-115.13671875 40.79907957220557, -115.122979710705 40.7990987183914, -115.122979710705 40.79891402213259, -115.113442387165 40.7989159942235, -115.113431787044 40.7777427671891, -115.122264382244 40.77772929827339, -115.122333103363 40.76309261947759, -115.1221518893897 40.71395582628604), (-115.0839839903945 40.71395582628604, -115.083996779961 40.71970580551879, -115.064927073615 40.71979771914559, -115.064946297562 40.72702166510858, -115.055408884191 40.72705971999079, -115.055432060725 40.7343026859072, -115.045902732191 40.73433535915499, -115.045945222504 40.75604971684229, -115.064992920126 40.7559924892667, -115.06500432873 40.7778007923348, -115.065747325301 40.77780120048339, -115.065743462545 40.79236112060858, -115.055704879077 40.79235867225399, -115.055962336237 40.79959629408368, -115.046253883636 40.7995988781762, -115.047156061676 40.81316690083191, -115.046701334479 40.82798681321668, -115.0466345291559 40.84706035607121))'), {u'website': u'http://www.fs.usda.gov/htnf', u'name': u'Humboldt-Toiyabe National Forest', u'boundary:type': u'protected_area', u'wikipedia': u'en:Humboldt-Toiyabe National Forest', u'name:de': u'Nationalforst Humboldt-Toiyabe', u'source': u'openstreetmap.org', u'name:fr': u"For\xeat nationale d'Humboldt-Toiyabe", u'protected': u'perpetuity', u'wikidata': u'Q5940240', u'protection_title': u'National Forest', u'ownership': u'national', u'operator': u'United States Forest Service', u'boundary': u'national_park', u'name:es': u'Bosque Nacional Humboldt-Toiyabe', u'protect_class': u'5'}),dsl.way(-2389847, wkt_loads('POLYGON ((-115.0865936220718 40.84706035607121, -115.086568027799 40.8469082993999, -115.086555990374 40.8465026810671, -115.086403186944 40.84604079367339, -115.086304731589 40.84593559950759, -115.086115636222 40.84572976367049, -115.085839583935 40.84542790619579, -115.084862576232 40.8444973855223, -115.084860869433 40.8423175117129, -115.084858982971 40.83870078953419, -115.084855659204 40.83507965611499, -115.084852604932 40.83145397482899, -115.084848742177 40.8278282991911, -115.084845598073 40.82420256126139, -115.084841735317 40.8205767610657, -115.080065392952 40.8205784605891, -115.075289140417 40.8205754014469, -115.070512169231 40.8205722063426, -115.065735916697 40.82056867133348, -115.060978079626 40.82056989499048, -115.056219613735 40.8205707787428, -115.051943543151 40.82057071076191, -115.051786158313 40.82146438223661, -115.051873294896 40.82172705654647, -115.051974175702 40.8219269167376, -115.052072720889 40.82220780766171, -115.052041369685 40.82246850763648, -115.051892608674 40.82269120646438, -115.051896830756 40.82295251634558, -115.052055563067 40.82319839413609, -115.052331615353 40.82349131177378, -115.052351647784 40.82361781861989, -115.052357666497 40.8238159736731, -115.052340778169 40.82398686918519, -115.052109641647 40.8241901894058, -115.052048735871 40.8242432116277, -115.051923331057 40.82447528531531, -115.051900424017 40.82485316806188, -115.051985494475 40.8251878837747, -115.052261816256 40.82547188778059, -115.052856231479 40.8258242060431, -115.05348810645 40.82611412117209, -115.054213765537 40.82644155720399, -115.054421276367 40.8266433064806, -115.054300183467 40.82673126571028, -115.054134534129 40.82671950609819, -115.053967986475 40.82673466444169, -115.053697503743 40.82665805699329, -115.053482267401 40.82671746685887, -115.053282122756 40.82666906889459, -115.052737743693 40.82663290634758, -115.052258941647 40.82678686893439, -115.051587720467 40.8270277703839, -115.051428359335 40.82707915895449, -115.05112068635 40.8271820719247, -115.050916858613 40.82725969837909, -115.050667216795 40.82768786577989, -115.050610982258 40.82780851889798, -115.050464646698 40.82812581855769, -115.05050587937 40.8283336802794, -115.050508304821 40.82865797860999, -115.050427366614 40.82898988825418, -115.050427905603 40.82937726134529, -115.050376611801 40.8295115057471, -115.050488002896 40.82975661153348, -115.050705844352 40.83001245587489, -115.050747885508 40.83019339513989, -115.050600921127 40.8303529910465, -115.050512167577 40.83054969859018, -115.050390176361 40.83066470494188, -115.050264771548 40.83089675615759, -115.050147271909 40.8312642029066, -115.050138737913 40.8314306611873, -115.050120232619 40.83178621032507, -115.049939222089 40.83189115507029, -115.049838341282 40.83209669403828, -115.049742131715 40.83254535674809, -115.049776627022 40.83298735553689, -115.049676195374 40.83317481161448, -115.049653018839 40.83356182041859, -115.049800791704 40.83418576030878, -115.05017673665 40.83471460933688, -115.050403740922 40.83506076154428, -115.050377420284 40.8351504087583, -115.050315975519 40.83522136522378, -115.050204045435 40.8353997075759, -115.050166585687 40.8354621000995, -115.050129485266 40.83551552110238, -115.049999319381 40.83590972055671, -115.050017195855 40.83610811074021, -115.050293787131 40.83638309663147, -115.050698388335 40.83674120185699, -115.050707371488 40.83684036179669, -115.050652304761 40.83710066442808, -115.050546932379 40.8374593094865, -115.050583763305 40.83782019539218, -115.050822176182 40.83818447747779, -115.051134879732 40.83844198836369, -115.051107481116 40.83856771910059, -115.050980998324 40.83883576264288, -115.050950725099 40.83913697052279, -115.050947311501 40.83917747581019, -115.05107774688 40.83958510985799, -115.051409943872 40.83991037257348, -115.051585025521 40.8400800712714, -115.051581881417 40.8401880611257, -115.051409045557 40.8404193994033, -115.051322627626 40.84053500027879, -115.051171890322 40.84082070551668, -115.051166141104 40.84101880916288, -115.051322627626 40.8409403832962, -115.051408596399 40.84099142128407, -115.051450907049 40.84101459564378, -115.051599039239 40.84122431983258, -115.052045501935 40.8417722772108, -115.0524271961 40.84210296590347, -115.052895128531 40.8423270938821, -115.05329532799 40.84243290540238, -115.053468433346 40.8425979764735, -115.053677111986 40.84235828689118, -115.054034282143 40.8419050014158, -115.054294074923 40.84153999222278, -115.05444319526 40.84130831805779, -115.054575696765 40.84123845546367, -115.054721134009 40.84153815731759, -115.05478698052 40.84171947288328, -115.054904031001 40.842180914683, -115.055165261086 40.84257256004061, -115.055456225406 40.84276671687579, -115.055505093758 40.84281700591787, -115.055881667525 40.84322420983679, -115.056180267525 40.84343188830869, -115.056323458982 40.84352886360258, -115.056908441895 40.8438089834515, -115.057532321859 40.84397269195628, -115.057910332931 40.8440240673937, -115.058137966024 40.8439468003517, -115.058267862414 40.84396698357189, -115.058609581548 40.8440448622023, -115.058753222162 40.84400218526779, -115.05876076801 40.84414645766019, -115.058751605195 40.8444615724813, -115.058716121741 40.84486638783459, -115.058558826735 40.84497178756539, -115.058434499899 40.8451679080882, -115.058370360188 40.84532889501368, -115.058340446289 40.8455445856213, -115.058489566626 40.84571827924869, -115.058674260249 40.84589251606071, -115.058817272042 40.84586791635142, -115.059031969395 40.8458264637818, -115.059340001706 40.84584066638649, -115.059787362717 40.84595625780648, -115.060142826075 40.8459712758422, -115.060497660612 40.84600430191768, -115.06095418444 40.84601198081771, -115.061244699603 40.8460168735676, -115.061754224032 40.84603440591869, -115.061939995632 40.8461726938739, -115.062223503936 40.84649269177549, -115.062502790158 40.84680371819759, -115.0627732652316 40.84706035607121, -115.0466345291559 40.84706035607121, -115.046701334479 40.82798681321668, -115.047156061676 40.81316690083191, -115.046253883636 40.7995988781762, -115.055962336237 40.79959629408368, -115.055704879077 40.79235867225399, -115.065743462545 40.79236112060858, -115.065747325301 40.77780120048339, -115.06500432873 40.7778007923348, -115.064992920126 40.7559924892667, -115.045945222504 40.75604971684229, -115.045902732191 40.73433535915499, -115.055432060725 40.7343026859072, -115.055408884191 40.72705971999079, -115.064946297562 40.72702166510858, -115.064927073615 40.71979771914559, -115.083996779961 40.71970580551879, -115.0839839903945 40.71395582628604, -115.1221518893897 40.71395582628604, -115.122333103363 40.76309261947759, -115.122264382244 40.77772929827339, -115.113431787044 40.7777427671891, -115.113442387165 40.7989159942235, -115.122979710705 40.79891402213259, -115.122979710705 40.7990987183914, -115.13671875 40.79907957220557, -115.13671875 40.84706035607121, -115.0865936220718 40.84706035607121))'), {u'website': u'http://www.fs.usda.gov/htnf', u'name': u'Humboldt-Toiyabe National Forest', u'boundary:type': u'protected_area', u'way_area': u'8.44604e+08', u'wikipedia': u'en:Humboldt-Toiyabe National Forest', u'name:de': u'Nationalforst Humboldt-Toiyabe', u'source': u'openstreetmap.org', u'name:fr': u"For\xeat nationale d'Humboldt-Toiyabe", u'protected': u'perpetuity', u'wikidata': u'Q5940240', u'protection_title': u'National Forest', u'ownership': u'national', u'operator': u'United States Forest Service', u'boundary': u'national_park', u'name:es': u'Bosque Nacional Humboldt-Toiyabe', u'protect_class': u'5'}))  # noqa

        self.assert_has_feature(
            11, 369, 769, 'landuse',
            {'kind': 'forest', 'id': -2389847})

    def test_nature_reserve_plus_operator_tag(self):
        # leisure=nature_reserve in Smith River is already taken care of by
        # operator (should be kind:forest).
        self.generate_fixtures(dsl.way(362882148, wkt_loads('LINESTRING (-123.75 41.70651731393285, -123.750550526525 41.70637809986129, -123.7509154439411 41.70572851523752)'), {u'source': u'openstreetmap.org', u'boundary': u'protected_area', u'attribution': u'US Forest Service'}),dsl.way(-6213964, wkt_loads('LINESTRING (-123.75 41.70651731393285, -123.750550526525 41.70637809986129, -123.7509154439411 41.70572851523752)'), {u'name': u'Smith River National Recreation Area', u'boundary:type': u'protected_area', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'ownership': u'national', u'operator': u'US Forest Service', u'boundary': u'national_park', u'protection_title': u'National Recreation Area', u'protect_class': u'5'}),dsl.way(-6213964, wkt_loads('POLYGON ((-123.75 41.70651731393285, -123.750550526525 41.70637809986129, -123.7509154439411 41.70572851523752, -123.77197265625 41.70572851523752, -123.77197265625 41.72213058512579, -123.75 41.72213058512579, -123.75 41.70651731393285))'), {u'name': u'Smith River National Recreation Area', u'boundary:type': u'protected_area', u'way_area': u'1.97111e+09', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'ownership': u'national', u'operator': u'US Forest Service', u'boundary': u'national_park', u'protection_title': u'National Recreation Area', u'protect_class': u'5'}))  # noqa

        self.assert_has_feature(
            14, 2559, 6099, 'landuse',
            {'kind': 'forest', 'id': -6213964})

    def test_operator_usnps_not_forest(self):
        # Counter example is Mojave National Preserve which is operated by
        # United States National Park Service so we don't want it to become
        # a forest (it should be kind:national_park).
        self.generate_fixtures(dsl.way(-175098, wkt_loads('POLYGON ((-115.48828125 35.31736632923786, -115.576171875 35.31736632923786, -115.576171875 35.38904996691166, -115.48828125 35.38904996691166, -115.48828125 35.31736632923786))'), {u'name': u'Mojave National Preserve', u'source': u'openstreetmap.org', u'boundary:type': u'protected_area', u'way_area': u'9.3602e+09', u'wikipedia': u'en:Mojave National Preserve', u'leisure': u'nature_reserve', u'phone': u'+1 760 733 4040', u'protected': u'perpetuity', u'wikidata': u'Q1943112', u'ownership': u'national', u'operator': u'National Park Service', u'ohv': u'no', u'boundary': u'national_park', u'protection_title': u'National Preserve', u'protect_class': u'2'}))  # noqa

        self.assert_has_feature(
            12, 733, 1617, 'landuse',
            {'kind': 'national_park', 'id': -175098})

    def test_nature_reserve_without_operator_with_protect_class(self):
        # Point Reyes is also leisure=nature_reserve but without an operator
        # but with a protect_class of 2 (it should be kind:national_park,
        # but might need some data work?), until data is fixed I think it'd
        # come thru as kind:nature_reserve?
        self.generate_fixtures(dsl.way(-1250137, wkt_loads('POLYGON ((-122.947998046875 38.09998264736477, -122.958984375 38.09998264736477, -122.958984375 38.10862766432127, -122.947998046875 38.10862766432127, -122.947998046875 38.09998264736477))'), {u'name': u'Point Reyes National Seashore', u'url': u'http://www.nps.gov/pore', u'boundary:type': u'protected_area', u'way_area': u'4.69789e+08', u'wikipedia': u'en:Point Reyes National Seashore', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'wikidata': u'Q2100791', u'boundary': u'national_park', u'protect_class': u'2'}))  # noqa

        self.assert_has_feature(
            15, 5192, 12627, 'landuse',
            {'kind': 'national_park', 'id': -1250137})

    def test_park_type_state_recreational_area(self):
        # leisure=park in San Luis Reservoir State Recreational Area has
        # boundary=national_park and leisure=park and
        # park:type=state_recreational_area and no protect_class. This
        # shouldn't be a kind national_park, just a kind:park!
        self.generate_fixtures(dsl.way(-3004556, wkt_loads('POLYGON ((-121.11328125 37.0551771066608, -121.124267578125 37.0551771066608, -121.124267578125 37.06394430056685, -121.11328125 37.06394430056685, -121.11328125 37.0551771066608))'), {u'website': u'https://www.parks.ca.gov/?page_id=558', u'admin_level': u'4', u'csp:globalid': u'{2C164FF0-718D-4737-B8A2-857BB52DB779}', u'attribution': u'CASIL CSP_Opbdys072008', u'name': u'San Luis Reservoir State Recreational Area', u'way_area': u'1.52544e+08', u'leisure': u'park', u'source': u'openstreetmap.org', u'boundary': u'national_park', u'park:type': u'state_recreational_area', u'csp:unitcode': u'333'}))  # noqa

        self.assert_has_feature(
            15, 5359, 12747, 'landuse',
            {'kind': 'park', 'id': -3004556})

    # Example forest in Colorado that only gets demoted because of
    # protect_class is present as 6 but operator is missing. Gets demoted
    # to what, though? propose kind:park since there isn't an operator
    # to say forest, and it's not a national park. Alternatively
    # boundary:type=protected_area could give us kind: protected_area
    # instead.

    def test_protection_title_national_forest(self):
        # This feature also has protection_title=National Forest, and the
        # name is "Arapaho National Forest", so it should probably be classed
        # as a forest.
        self.generate_fixtures(dsl.way(-396026, wkt_loads('POLYGON ((-105.99609375 39.90973623453718, -106.0400390625 39.90973623453718, -106.0400390625 39.94343646197419, -105.99609375 39.94343646197419, -105.99609375 39.90973623453718))'), {u'attribution': u'US Forest Service', u'name': u'Arapaho National Forest', u'boundary:type': u'protected_area', u'way_area': u'2.24218e+09', u'source': u'openstreetmap.org', u'boundary': u'national_park', u'protection_title': u'National Forest', u'protect_class': u'6'}))  # noqa

        self.assert_has_feature(
            13, 1683, 3103, 'landuse',
            {'kind': 'forest', 'id': -396026})

    def test_nature_reserve_protected_area(self):
        # leisure=nature_reserve in North Farallon Islands State Marine
        # Reserve has boundary=protected_area with protect_class=4 in tile
        # 11/323/791. It's operator=California Department of Fish & Wildlife
        # so we'd just want this to be kind:nature_reserve.
        self.generate_fixtures(dsl.way(436801947, wkt_loads('POLYGON ((-123.113853129735 37.82324157321668, -123.105016761611 37.82310597141278, -123.095260877963 37.82187695782967, -123.081645921685 37.81815097732607, -123.070493876422 37.81382996121289, -123.059354946562 37.80813800313569, -123.053531258407 37.8041641173009, -123.048501591131 37.80003400199789, -123.046875 37.79847598097073, -123.046875 37.76020137339589, -123.113651368122 37.76019970329988, -123.113853129735 37.82324157321668))'), {u'name': u'North Farallon Islands State Marine Reserve', u'way_area': u'7.40425e+07', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'operator': u'California Department of Fish & Wildlife', u'boundary': u'protected_area', u'protect_class': u'4'}))  # noqa

        self.assert_has_feature(
            11, 323, 791, 'landuse',
            {'kind': 'nature_reserve', 'id': 436801947})

    def test_nature_reserve_national_park(self):
        # leisure=nature_reserve in Mount Tamalpais Watershed has
        # boundary=national_park with boundary:type=protected_area and
        # operator=Marin Municipal Water District and protect_class=4. It
        # should just be kind:nature_reserve.
        self.generate_fixtures(dsl.way(297463477, wkt_loads('LINESTRING (-122.6411420653692 37.92686760148134, -122.641646603947 37.92730740073578, -122.643997315383 37.93026248763928, -122.645778315265 37.93285199701877, -122.6513671875 37.93465971190437)'), {u'source': u'openstreetmap.org', u'name': u'Mount Tamalpais Watershed', u'leisure': u'nature_reserve'}),dsl.way(-7473345, wkt_loads('LINESTRING (-122.6411420653692 37.92686760148134, -122.641646603947 37.92730740073578, -122.643997315383 37.93026248763928, -122.645778315265 37.93285199701877, -122.6513671875 37.93465971190437)'), {u'website': u'http://www.marinwater.org/137/Watershed', u'name': u'Mount Tamalpais Watershed', u'area': u'yes', u'boundary:type': u'protected_area', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'operator': u'Marin Municipal Water District', u'boundary': u'national_park', u'protection_title': u'Watershed', u'protect_class': u'4'}),dsl.way(-7473345, wkt_loads('POLYGON ((-122.6411420653692 37.92686760148134, -122.641646603947 37.92730740073578, -122.643997315383 37.93026248763928, -122.645778315265 37.93285199701877, -122.6513671875 37.93465971190437, -122.6513671875 37.96152331396613, -122.607421875 37.96152331396613, -122.607421875 37.92686760148134, -122.6411420653692 37.92686760148134))'), {u'website': u'http://www.marinwater.org/137/Watershed', u'name': u'Mount Tamalpais Watershed', u'area': u'yes', u'boundary:type': u'protected_area', u'way_area': u'1.23256e+08', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'operator': u'Marin Municipal Water District', u'boundary': u'national_park', u'protection_title': u'Watershed', u'protect_class': u'4'}))  # noqa

        self.assert_has_feature(
            13, 1305, 3161, 'landuse',
            {'kind': 'nature_reserve', 'id': -7473345})

    def test_common(self):
        # leisure=common in Blithedale Summit Open Space Preserve with
        # boundary=national_park and boundary:type=protected_area and
        # protect_class=5 and operator=Marin County Parks should just be
        # kind:common.
        self.generate_fixtures(dsl.way(297452972, wkt_loads('POLYGON ((-122.5472970219795 37.91820111976661, -122.547357724927 37.91840500183667, -122.547372906455 37.91848699479388, -122.550627323066 37.91847608130269, -122.552473181312 37.91992926218708, -122.550031290875 37.92103078619777, -122.550084920298 37.92171398641209, -122.552490234375 37.92166645520442, -122.552490234375 37.92686760148134, -122.54150390625 37.92686760148134, -122.54150390625 37.91820111976661, -122.5472970219795 37.91820111976661))'), {u'website': u'http://www.marincountyparks.org/Depts/PK/Divisions/Open-Space/Blithedale-Summit', u'name': u'Blithedale Summit Open Space Preserve', u'boundary:type': u'protected_area', u'way_area': u'4.14289e+06', u'leisure': u'common', u'source': u'openstreetmap.org', u'operator': u'Marin County Parks', u'boundary': u'national_park', u'protection_title': u'Open Space Preserve', u'protect_class': u'5'}))  # noqa

        self.assert_has_feature(
            15, 5229, 12648, 'landuse',
            {'kind': 'common', 'id': 297452972})

    def test_nature_reserve_boundary_type(self):
        # leisure=nature_reserve in Glen Canyon National Recreation Area with
        # boundary=national_park and boundary:type=protected_area and
        # protect_class=5 and protection_title=National Recreation Area which
        # I think should default to kind:nature_reserve.
        self.generate_fixtures(dsl.way(-5273153, wkt_loads('POLYGON ((-111.005859375 37.57941251343838, -111.09375 37.57941251343838, -111.09375 37.64903402157862, -111.005859375 37.64903402157862, -111.005859375 37.57941251343838))'), {u'gnis:state_id': u'49', u'name': u'Glen Canyon National Recreation Area', u'boundary:type': u'protected_area', u'way_area': u'8.05695e+09', u'gnis:county_id': u'055', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'wikidata': u'Q1373278', u'ownership': u'national', u'gnis:created': u'02/25/1989', u'boundary': u'national_park', u'gnis:feature_id': u'23865', u'protection_title': u'National Recreation Area', u'protect_class': u'5'}))  # noqa

        self.assert_has_feature(
            12, 784, 1585, 'landuse',
            {'kind': 'nature_reserve', 'id': -5273153})

    def test_plain_nature_reserve(self):
        # leisure=nature_reserve in Parque Natural Sierra de And√∫jar with
        # finally kind:nature_reserve.
        self.generate_fixtures(dsl.way(373769670, wkt_loads('POLYGON ((-4.042968749999999 38.27268853598096, -4.0869140625 38.27268853598096, -4.0869140625 38.30718056188315, -4.042968749999999 38.30718056188315, -4.042968749999999 38.27268853598096))'), {u'source': u'openstreetmap.org', u'way_area': u'1.21007e+09', u'name': u'Parque Natural Sierra de And\xfajar', u'leisure': u'nature_reserve'}))  # noqa

        self.assert_has_feature(
            13, 4003, 3151, 'landuse',
            {'kind': 'nature_reserve', 'id': 373769670})

    def test_protected_area_protect_class_5(self):
        # boundary=protected_area in Naturpark Steigerwald with
        # protect_class=5 should end up with kind: protected_area
        self.generate_fixtures(dsl.way(-3875431, wkt_loads('POLYGON ((10.5908203125 49.72447918871298, 10.546875 49.72447918871298, 10.546875 49.75287993415022, 10.5908203125 49.75287993415022, 10.5908203125 49.72447918871298))'), {u'name': u'Naturpark Steigerwald', u'way_area': u'3.03595e+09', u'wikipedia': u'de:Naturpark Steigerwald', u'source': u'openstreetmap.org', u'wikidata': u'Q454707', u'protection_title': u'Naturpark', u'protect_class': u'5', u'boundary': u'protected_area', u'WDPA_ID:ref': u'6986', u'SGD-ID:ref': u'NP-00014'}))  # noqa

        self.assert_has_feature(
            13, 4336, 2787, 'landuse',
            {'kind': 'protected_area', 'id': -3875431})

    def test_national_park_operator_national_park_service(self):
        # boundary=national_park in Muir Woods National Monument with
        # leisure=nature_reserve and operator=National Park Service and
        # protect_class=3 should end up with kind:national_park
        self.generate_fixtures(dsl.way(296776452, wkt_loads('POLYGON ((-122.5799560546875 37.89653044754303, -122.58544921875 37.89653044754303, -122.58544921875 37.90086509257003, -122.5799560546875 37.90086509257003, -122.5799560546875 37.89653044754303))'), {u'attribution': u'National Park Service', u'way_area': u'3.28748e+06', u'source': u'openstreetmap.org', u'natural': u'wood', u'boundary': u'national_park'}),dsl.way(-6229828, wkt_loads('POLYGON ((-122.5799560546875 37.89653044754303, -122.58544921875 37.89653044754303, -122.58544921875 37.90086509257003, -122.5799560546875 37.90086509257003, -122.5799560546875 37.89653044754303))'), {u'website': u'http://www.nps.gov/muwo/index.htm', u'name': u'Muir Woods National Monument', u'boundary:type': u'protected_area', u'way_area': u'3.28748e+06', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'wikidata': u'Q1195839', u'ownership': u'national', u'operator': u'National Park Service', u'boundary': u'national_park', u'protection_title': u'National Monument', u'protect_class': u'3'}))  # noqa

        self.assert_has_feature(
            16, 10452, 25302, 'landuse',
            {'kind': 'national_park', 'id': -6229828})

    def test_park_protect_class_5(self):
        # leisure=park in Henry W. Coe State Park with boundary=protected_area
        # and protect_class=5 should end up with kind:park.
        self.generate_fixtures(dsl.way(-318202, wkt_loads('POLYGON ((-121.4208984375 37.12528628496678, -121.46484375 37.12528628496678, -121.46484375 37.16031654673677, -121.4208984375 37.16031654673677, -121.4208984375 37.12528628496678))'), {u'csp:globalid': u'{4BE5C08F-9239-4491-9400-5B776F304A18}', u'attribution': u'CASIL CSP_Opbdys072008', u'name': u'Henry W. Coe State Park', u'short_name': u'Coe Park', u'way_area': u'5.49599e+08', u'leisure': u'park', u'source': u'openstreetmap.org', u'boundary': u'protected_area', u'park:type': u'state_park', u'csp:unitcode': u'432', u'protect_class': u'5'}))  # noqa

        self.assert_has_feature(
            13, 1332, 3184, 'landuse',
            {'kind': 'park', 'id': -318202})

    def test_nature_reserve_plus_operator_national_park_service(self):
        # operator=United States National Park Service and protect_class=2 in
        # Yosemite National Park with boundary=national_park and
        # leisure=nature_reserve should end up with kind:national_park.
        self.generate_fixtures(dsl.way(-1643367, wkt_loads('POLYGON ((-119.70703125 37.82280243352756, -119.7509765625 37.82280243352756, -119.7509765625 37.85750715625202, -119.70703125 37.85750715625202, -119.70703125 37.82280243352756))'), {u'name:tr': u'Yosemite Ulusal Park\u0131', u'ref:whc': u'308', u'wikidata': u'Q180402', u'operator': u'United States National Park Service', u'addr:housenumber': u'PO box 577', u'protect_class': u'2', u'way_area': u'4.85876e+09', u'wikipedia': u'en:Yosemite National Park', u'addr:state': u'CA', u'name:de': u'Yosemite-Nationalpark', u'source': u'openstreetmap.org', u'whc:inscription_date': u'1984', u'heritage': u'1', u'boundary': u'national_park', u'whc:criteria': u'(vii)(viii)', u'protection_title': u'National Park', u'website': u'http://www.nps.gov/yose/', u'boundary:type': u'protected_area', u'leisure': u'nature_reserve', u'phone': u'602 278 8888', u'ownership': u'national', u'addr:city': u'Yosemiet National Park', u'name': u'Yosemite National Park', u'addr:postcode': u'95389', u'protected': u'perpetuity', u'heritage:operator': u'whc'}))  # noqa

        self.assert_has_feature(
            13, 1371, 3164, 'landuse',
            {'kind': 'national_park', 'id': -1643367})

    def test_boundary_national_park_plus_operator_usnps_redwood(self):
        # operator=United States National Park Service and protect_class=2 in
        # Redwood National Park with boundary=national_park and
        # leisure=nature_reserve should end up with kind:national_park.
        self.generate_fixtures(dsl.way(-215231, wkt_loads('POLYGON ((-123.9697265625 41.14556973100947, -124.013671875 41.14556973100947, -124.013671875 41.17865397233168, -123.9697265625 41.17865397233168, -123.9697265625 41.14556973100947))'), {u'website': u'http://www.nps.gov/redw/index.htm', u'name': u'Redwood National Park', u'boundary:type': u'protected_area', u'way_area': u'5.13578e+08', u'wikipedia': u'en:Redwood National and State Parks', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'protected': u'perpetuity', u'wikidata': u'Q191824', u'ownership': u'national', u'operator': u'United States National Park Service', u'boundary': u'national_park', u'gnis:feature_id': u'277109', u'protection_title': u'National Park', u'protect_class': u'2'}))  # noqa

        self.assert_has_feature(
            13, 1274, 3066, 'landuse',
            {'kind': 'national_park', 'id': -215231})

    def test_boundary_national_park_plus_operator_usnps_yellowstone(self):
        # operator=United States National Park Service and protect_class=2 in
        # Yellowstone National Park with boundary=national_park and
        # leisure=nature_reserve should end up with kind:national_park.
        self.generate_fixtures(dsl.way(-1453306, wkt_loads('POLYGON ((-110.0390625 44.18220395771564, -110.0830078125 44.18220395771564, -110.0830078125 44.21370990970205, -110.0390625 44.21370990970205, -110.0390625 44.18220395771564))'), {u'ref:whc': u'28', u'wikidata': u'Q351', u'operator': u'United States National Park Service', u'way_area': u'1.75564e+10', u'wikipedia': u'en:Yellowstone National Park', u'source': u'openstreetmap.org', u'whc:inscription_date': u'1978', u'heritage': u'1', u'gnis:feature_id': u'1609331', u'whc:criteria': u'(vii)(viii)(ix)(x)', u'protection_title': u'National Park', u'website': u'http://www.nps.gov/yell/', u'name:sk': u'Yellowstonsk\xfd n\xe1rodn\xfd park', u'protect_id': u'2', u'boundary:type': u'protected_area', u'leisure': u'nature_reserve', u'ownership': u'national', u'boundary': u'national_park', u'name': u'Yellowstone National Park', u'protected': u'perpetuity', u'source:url': u'http://nrinfo.nps.gov/Reference.mvc/Profile?Code=2167750', u'heritage:operator': u'whc'}))  # noqa

        self.assert_has_feature(
            13, 1591, 2972, 'landuse',
            {'kind': 'national_park', 'id': -1453306})

    def test_boundary_national_park_adirondack(self):
        # boundary=national_park in Adirondack Park should end up with
        # kind:park.
        self.generate_fixtures(dsl.way(-1695394, wkt_loads('POLYGON ((-74.04785156249999 43.26120612479976, -74.091796875 43.26120612479976, -74.091796875 43.29320031385281, -74.04785156249999 43.29320031385281, -74.04785156249999 43.26120612479976))'), {u'name': u'Adirondack Park', u'way_area': u'4.55071e+10', u'wikipedia': u'en:Adirondack Park', u'source': u'openstreetmap.org', u'wikidata': u'Q357550', u'boundary': u'national_park'}))  # noqa

        self.assert_has_feature(
            13, 2410, 3001, 'landuse',
            {'kind': 'park', 'id': -1695394})

    def test_boundary_national_park_plus_operator_usnps_shenandoah(self):
        # operator=United States National Park Service and protect_class=2 in
        # Shenandoah National Park with boundary=national_park and
        # leisure=park should end up with kind:national_park.
        self.generate_fixtures(dsl.way(-5548542, wkt_loads('POLYGON ((-78.310546875 38.58252615935331, -78.35449218749999 38.58252615935331, -78.35449218749999 38.61687046392971, -78.310546875 38.61687046392971, -78.310546875 38.58252615935331))'), {u'website': u'http://www.nps.gov/shen/', u'gnis:state_id': u'51', u'name': u'Shenandoah National Park', u'boundary:type': u'protected_area', u'way_area': u'1.26526e+09', u'wikipedia': u'en:Shenandoah National Park', u'gnis:county_id': u'139', u'ele': u'920', u'source': u'openstreetmap.org', u'protected': u'perpetuity', u'wikidata': u'Q1137401', u'ownership': u'national', u'operator': u'United States National Park Service', u'gnis:created': u'09/13/1996', u'boundary': u'national_park', u'gnis:feature_id': u'1488805', u'protection_title': u'National Park', u'protect_id': u'2'}))  # noqa

        self.assert_has_feature(
            13, 2313, 3142, 'landuse',
            {'kind': 'national_park', 'id': -5548542})

    def test_designation_national_park(self):
        # designation=national_park in Cairngorms National Park with
        # boundary=national_park should end up with kind:national_park.
        self.generate_fixtures(dsl.way(-1947603, wkt_loads('POLYGON ((-3.5595703125 56.92099675839103, -3.603515625 56.92099675839103, -3.603515625 56.94497418085159, -3.5595703125 56.94497418085159, -3.5595703125 56.92099675839103))'), {u'name': u'Cairngorms National Park', u'designation': u'national_park', u'name:gd': u"P\xe0irc N\xe0iseanta a' Mhonaidh Ruaidh", u'way_area': u'1.52651e+10', u'wikipedia': u'en:Cairngorms National Park', u'source:ref:gss': u'ONS_OpenData', u'note': u'generally taken from OS_OpenData_250000 raster tiles, but using other surveyed features where available', u'source': u'openstreetmap.org', u'wikidata': u'Q1025953', u'boundary': u'national_park', u'ref:gss': u'S21000001'}))  # noqa

        self.assert_has_feature(
            13, 4014, 2512, 'landuse',
            {'kind': 'national_park', 'id': -1947603})

    def test_designation_aonb(self):
        # boundary=national_park in North Wessex Downs AONB with
        # designation=area_of_outstanding_natural_beauty should end up with
        # kind:park.
        self.generate_fixtures(dsl.way(-2904192, wkt_loads('POLYGON ((-1.8017578125 51.37178037591738, -1.845703125 51.37178037591738, -1.845703125 51.39920565355377, -1.8017578125 51.39920565355377, -1.8017578125 51.37178037591738))'), {u'name': u'North Wessex Downs AONB', u'short_name': u'North Wessex Downs', u'area': u'yes', u'way_area': u'4.45015e+09', u'wikipedia': u'nn:North Wessex Downs', u'designation': u'area_of_outstanding_natural_beauty', u'source': u'openstreetmap.org', u'wikidata': u'Q7057217', u'boundary': u'national_park'}))  # noqa

        self.assert_has_feature(
            13, 4054, 2728, 'landuse',
            {'kind': 'park', 'id': -2904192})

    def test_parks_canada(self):
        # operator:en=Parks Canada and boundary=national_park in Riding
        # Mountain National Park with leisure=nature_reserve.
        self.generate_fixtures(dsl.way(185735773, wkt_loads('POLYGON ((-100.3271484375 50.81981826215652, -100.37109375 50.81981826215652, -100.37109375 50.84757295365387, -100.3271484375 50.84757295365387, -100.3271484375 50.81981826215652))'), {u'name:en': u'Riding Mountain National Park', u'attribution': u'\xa92001 Her Majesty the Queen in Right of Manitoba, as represented by the Minister of Conservation. All rights reserved.', u'name': u'Riding Mountain National Park', u'operator:fr': u'Parcs Canada', u'boundary:type': u'protected_area', u'way_area': u'7.73689e+09', u'wikipedia': u'en:Riding Mountain National Park', u'leisure': u'nature_reserve', u'source': u'openstreetmap.org', u'name:fr': u'Parc national du Mont-Riding', u'wikidata': u'Q795190', u'operator:en': u'Parks Canada', u'boundary': u'national_park'}))  # noqa

        self.assert_has_feature(
            13, 1812, 2748, 'landuse',
            {'kind': 'national_park', 'id': 185735773})
