# -*- encoding: utf-8 -*-
import dsl
from shapely.wkt import loads as wkt_loads

from . import FixtureTest


class LessLanduseBuildingLabelPlacements(FixtureTest):
    def test_pier(self):
        # The landuse for a pier
        self.generate_fixtures(dsl.way(82206919, wkt_loads('POLYGON ((-122.426849807541 37.8089786736717, -122.426837680284 37.80915461355458, -122.426804173124 37.80932842386229, -122.426753238648 37.8094852005509, -122.42667813949 37.80966000368206, -122.426590374087 37.80980230150008, -122.426495691656 37.80996617430829, -122.426381695446 37.8101113813519, -122.426252966866 37.81024700702779, -122.42610276855 37.81037631604819, -122.425936490391 37.81049072098619, -122.425754132389 37.810587099202, -122.425571684554 37.81066658629568, -122.425370641594 37.8107301049385, -122.42517471903 37.8107736098545, -122.424957506395 37.81079802369498, -122.424805870775 37.81079901728138, -122.424662409824 37.81078517804159, -122.424582010606 37.8107724743269, -122.424504216502 37.81075345423587, -122.424433069932 37.81072591767768, -122.424378093036 37.81069199375939, -122.42433245862 37.81064217241178, -122.424302993879 37.8105924220012, -122.424297693818 37.8105394069047, -122.424311078716 37.81048539817969, -122.42434189093 37.81043976396991, -122.424400910245 37.81040697545338, -122.424468014396 37.81039001342301, -122.424547066141 37.81039845895331, -122.42460752276 37.81042081476407, -122.424649024926 37.81045246774188, -122.424675884553 37.81048958545409, -122.424687921978 37.81052989682989, -122.424691964397 37.81057546001328, -122.424714781605 37.81060299662759, -122.424750983711 37.8106252814059, -122.424812697971 37.8106357850571, -122.424945379138 37.81063479146851, -122.425130521918 37.81061357125258, -122.425306232388 37.81057439545318, -122.425489937863 37.81051719307118, -122.425656216023 37.81044941599798, -122.425813061871 37.81036460585538, -122.42596873991 37.81025758170368, -122.42610276855 37.8101421118383, -122.426210117227 37.81002451265628, -122.426313333653 37.80989208028149, -122.426404512654 37.80975638298231, -122.426486259345 37.80960599431378, -122.42655471097 37.80944389500019, -122.426598997913 37.80929549290848, -122.426627205013 37.80914297413997, -122.426641937384 37.8089786736717, -122.426635200019 37.80881870215168, -122.426612382811 37.80864276146838, -122.426573485759 37.8084490062172, -122.426517161391 37.80817128947058, -122.426719731487 37.80814588113949, -122.426780098275 37.80842558521829, -122.426817558022 37.80862267624071, -122.426843070176 37.80880805629729, -122.426849807541 37.8089786736717))'), {u'name': u'Municipal Pier', u'area': u'yes', u'way_area': u'13096.5', u'man_made': u'pier', u'access': u'yes', u'source': u'openstreetmap.org'}))

        self.assert_no_matching_feature(
            14, 2620, 6330, 'landuse',
            {'id': 82206919, 'kind': 'pier', 'label_placement': True})

        self.assert_has_feature(
            15, 5240, 12661, 'landuse',
            {'id': 82206919, 'kind': 'pier', 'label_placement': True})

    def test_building(self):
        # The building known as 650 California Street
        self.generate_fixtures(dsl.way(260520160, wkt_loads('POLYGON ((-122.405470532599 37.79301345436149, -122.405037544632 37.79306768882648, -122.404967925198 37.79272041719198, -122.405400823333 37.79266618247207, -122.405470532599 37.79301345436149))'), {u'building': u'yes', u'addr:housenumber': u'650', u'name': u'650 California Street', u'building:levels': u'33', u'way_area': u'2416.95', u'height': u'142', u'source': u'openstreetmap.org', u'alt_name': u'Hartford Building', u'addr:street': u'California Street'}))

        self.assert_no_matching_feature(
            15, 5242, 12663, 'buildings',
            {'id': 260520160, 'kind': 'building', 'label_placement': True})

        self.assert_has_feature(
            16, 10484, 25326, 'buildings',
            {'id': 260520160, 'kind': 'building', 'label_placement': True})
