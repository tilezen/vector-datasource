# -*- encoding: utf-8 -*-
import dsl
from shapely.wkt import loads as wkt_loads

from . import FixtureTest


class IntermittentWater(FixtureTest):
    def test_river(self):
        # Arizona Canal Diversion Channel (ACDC)
        self.generate_fixtures(dsl.way(107817218, wkt_loads('LINESTRING (-112.079922133042 33.56788009736549, -112.080132698145 33.56800315140899, -112.080401384246 33.56808758254908, -112.080915669746 33.56823466319437, -112.082132707293 33.56861520045448, -112.082817043877 33.56882335751829, -112.082937058799 33.56885202492069, -112.083434994961 33.56893069181679, -112.08364951265 33.56895209878089, -112.083878493216 33.56895337122258, -112.084593731846 33.56892350626118, -112.085125803988 33.56888061746398, -112.085864039489 33.56883061793179, -112.086061399357 33.56883061793179, -112.086207285759 33.56883765379588, -112.086387487805 33.56885202492069, -112.086567779682 33.56888061746398, -112.086765229382 33.5689092099979, -112.086936897433 33.56895209878089, -112.089932329748 33.56965298679868, -112.092799123314 33.570325202223, -112.094798862968 33.57079008391828, -112.095631511405 33.57098319134109, -112.095700232524 33.57101178317858, -112.097365259903 33.57153376966821, -112.098043308279 33.57173406074979, -112.09830076544 33.57180561455117, -112.098532620615 33.57186279767199, -112.098807235597 33.57190568498778, -112.100075477115 33.57207177022069, -112.10094441749 33.57219182442179, -112.10321607718 33.57251538612859, -112.104472460936 33.5727209141703, -112.107330720507 33.573485989127, -112.107631117138 33.57352176530898, -112.107861894335 33.5735207174712, -112.108068866176 33.5735074698071, -112.108326413168 33.57346435875029, -112.108518293313 33.57341585878569, -112.108692296984 33.57334737499288, -112.108841327489 33.57327148141478, -112.109055935011 33.57313556138831, -112.109244671052 33.57302119679498, -112.109716466239 33.57269120020469, -112.10979408068 33.57264217588151, -112.110171732425 33.57237759374799, -112.110669488924 33.5720342719604, -112.11083262298 33.57193420167289, -112.110935569911 33.57187701859928, -112.111098703967 33.57179827954081, -112.111270282186 33.57175539217168, -112.111579302644 33.57169820897978, -112.111759594521 33.5717053943044, -112.113785205655 33.57169820897978, -112.116600435924 33.57171969010469, -112.121706190505 33.57078821272019, -112.12206857089 33.57072519074548, -112.122336268845 33.57069480246101, -112.122908405849 33.57069038642859, -112.123946678655 33.57068185375518, -112.125439319331 33.57061366718579, -112.127269726554 33.57057841373529, -112.128037336964 33.57058350340639, -112.128408341176 33.5706145653627, -112.128726075292 33.5706630669012, -112.129084682754 33.57077077315218, -112.130518124453 33.57125286737968, -112.130885625235 33.57133796896889, -112.133884111822 33.57236412136869, -112.134617047263 33.57262279068338, -112.13721470557 33.57349901225768, -112.137377031141 33.57357498048119, -112.137732674162 33.57375386105878, -112.137979441371 33.5739058718357, -112.138598919591 33.5742994071086, -112.139509541794 33.57486231361109, -112.139598564839 33.57490512459229, -112.141723080486 33.5762612187934, -112.142922061896 33.57702551394691, -112.144707643186 33.57817815583351, -112.150246924722 33.58170049991097, -112.150840711125 33.58208180103058, -112.15133882695 33.58241198623269, -112.152269661248 33.5829161673189, -112.153754037423 33.5835108233088, -112.155089293261 33.58405518514159, -112.155731139532 33.58429039568759, -112.155990662818 33.58442210732638, -112.156378914683 33.58469638120179, -112.156601247716 33.58488100107938, -112.156860860833 33.58519269122079, -112.157486896755 33.58609318128699, -112.158277593868 33.58721995928438, -112.158445039837 33.5874131047826, -112.159626683762 33.58823709259519, -112.160266194412 33.5886989593541, -112.160528412644 33.5888728696575, -112.160637018962 33.58893071496038, -112.160747871068 33.5889798796958, -112.161454665533 33.589259751476, -112.162793873959 33.58981627456168, -112.163021147726 33.5899508961862, -112.163286689724 33.59016528761131, -112.164777982927 33.59187231823078, -112.165627070533 33.5928761520003, -112.165757146587 33.5930460879661, -112.165856500257 33.59322709821038, -112.165937528296 33.59345046088628, -112.166037600618 33.59385730123219, -112.166135786479 33.59436201405778, -112.166268287983 33.594730089644, -112.166334314157 33.594844575123, -112.166473912352 33.59504571002811, -112.166723105012 33.5953023658664, -112.166950378778 33.5954612975537, -112.167233976914 33.5956085560308, -112.167446338647 33.59569176294529, -112.167767396529 33.59577392221189, -112.168838817169 33.59596622547188, -112.169108221922 33.59604681313078, -112.169404216809 33.5961993084204)'), {u'name': u'Arizona Canal Diversion Channel', u'intermittent': u'yes', u'surface': u'concrete', u'source': u'openstreetmap.org', u'oneway': u'yes', u'waterway': u'river', u'smoothness': u'excellent'}))

        self.assert_has_feature(
            16, 12353, 26272, 'water',
            {'kind': 'river', 'intermittent': True})

    def test_drain(self):
        # 10th Street Wash
        self.generate_fixtures(dsl.way(1118307665, wkt_loads('POINT (-112.058866341435 33.5686649007124)'), {u'source': u'openstreetmap.org', u'intermittent': u'yes', u'ford': u'yes'}),dsl.way(1118307727, wkt_loads('POINT (-112.059142842879 33.56955785378447)'), {u'source': u'openstreetmap.org', u'intermittent': u'yes', u'ford': u'yes'}),dsl.way(1118307742, wkt_loads('POINT (-112.055665913572 33.57859225294889)'), {u'source': u'openstreetmap.org', u'intermittent': u'yes', u'ford': u'yes'}),dsl.way(1118307753, wkt_loads('POINT (-112.058877031386 33.57046412060251)'), {u'source': u'openstreetmap.org', u'intermittent': u'yes', u'ford': u'yes'}),dsl.way(1118307813, wkt_loads('POINT (-112.058662334034 33.57134567825559)'), {u'source': u'openstreetmap.org', u'intermittent': u'yes', u'ford': u'yes'}),dsl.way(1566700862, wkt_loads('POINT (-112.055435316038 33.57901009011729)'), {u'source': u'openstreetmap.org', u'intermittent': u'yes', u'ford': u'yes'}),dsl.way(96528126, wkt_loads('LINESTRING (-112.052534027165 33.58366132016668, -112.052580470065 33.58355415385819, -112.052691322172 33.58337252462231, -112.052775673977 33.58333136425608, -112.052805587876 33.58303777802018, -112.052847718862 33.58295418471351, -112.052881765012 33.58281461289739, -112.052962972713 33.58271739893598, -112.053055319525 33.58267159832509, -112.053146678189 33.5826302131116, -112.053219082401 33.58260469346738, -112.053273160981 33.58257805125008, -112.053342780416 33.58243795496079, -112.053358231438 33.58238377236057, -112.05347231748 33.58222721139649, -112.053537175843 33.58216808935237, -112.05409062789 33.581873825614, -112.054275680838 33.58174652555258, -112.05438572446 33.58155426543299, -112.05440979931 33.5814515119899, -112.054399109358 33.58126598670879, -112.054380334569 33.58108278103789, -112.054364164894 33.58087951808181, -112.054315925363 33.58080565178579, -112.054374944677 33.58062686066189, -112.054428574099 33.58052635129889, -112.054702200935 33.58024712474779, -112.054841619467 33.5799432001016, -112.054991907614 33.5795744627051, -112.055059191429 33.57941535206928, -112.055150819588 33.57932150210239, -112.055255383487 33.57922869980179, -112.055409175064 33.5790690646434, -112.055435316038 33.57901009011729, -112.055471518144 33.57893487508581, -112.055519128854 33.57884955646328, -112.055588568626 33.57876551005359, -112.055640131923 33.57868078999229, -112.055665913572 33.57859225294889, -112.055667171213 33.57848081439408, -112.055682622236 33.57821250808259, -112.055693761346 33.57782857040358, -112.055699241069 33.57772581252457, -112.055748199252 33.57768397588769, -112.055911602802 33.57764161533659, -112.056002063151 33.57754469491628, -112.056045721274 33.57739246602099, -112.056307220853 33.57689648535348, -112.056424810324 33.5766768968051, -112.056472331202 33.57631286057099, -112.056530003044 33.5761294198557, -112.056515270673 33.57565506176358, -112.056563330541 33.575448792269, -112.056641394139 33.57526160751521, -112.056834531925 33.57501589416538, -112.057118758881 33.57472759360162, -112.057537283972 33.57423369327951, -112.057749196547 33.57370857960868, -112.057818905813 33.57349399760408, -112.057907389869 33.57298452225319, -112.057934788485 33.57283587793059, -112.058046898232 33.57243702188478, -112.058154965561 33.57211765130359, -112.058253420916 33.5719386176416, -112.058598463817 33.57142269623728, -112.058662334034 33.57134567825559, -112.05870796845 33.57127651919298, -112.058771120014 33.5711899954393, -112.058846488667 33.57085101010527, -112.05885960407 33.57062010412001, -112.058877031386 33.57046412060251, -112.058943596549 33.57020611845571, -112.059056604612 33.56978891230839, -112.05912820034 33.56961099655118, -112.059142842879 33.56955785378447, -112.059159461712 33.56950635766377, -112.059168085539 33.56931938457198, -112.059152005695 33.56913390806248, -112.059055436802 33.5689438653338, -112.058905238486 33.56878301355988, -112.058866341435 33.5686649007124, -112.05888367892 33.56841647398682, -112.058948088125 33.56823990270389, -112.059219020015 33.568032118485, -112.059371913276 33.56783541163838)'), {u'name': u'10th Street Wash', u'intermittent': u'yes', u'is_in:city': u'Phoenix', u'is_in:country_code': u'USA', u'is_in:state': u'Arizona', u'source': u'openstreetmap.org', u'is_in:country': u'United States of America', u'is_in:county': u'Maricopa', u'oneway': u'yes', u'waterway': u'drain', u'is_in:state_code': u'AZ', u'is_in:municipality': u'Phoenix of Phoenix', u'is_in': u'USA;AZ;Arizona;Maricopa;Phoenix'}))

        self.assert_has_feature(
            16, 12368, 26272, 'water',
            {'kind': 'drain', 'intermittent': True})

    def test_unnamed_drain(self):
        # Unnamed drain
        self.generate_fixtures(dsl.way(61954975, wkt_loads('LINESTRING (-112.037643103858 33.5772040880044, -112.037477185025 33.57720251631478, -112.037265002955 33.577194358497, -112.037106809633 33.57720086978289, -112.036973679308 33.57717677053839, -112.036890764808 33.57715431782019, -112.036773085505 33.5771912151174, -112.036670947058 33.57714780653078, -112.036593691943 33.57715910773388, -112.036443313965 33.57714615999777, -112.036348811197 33.57712849718689, -112.036169417634 33.57714615999777, -112.036030538092 33.5771124809062, -112.035897407766 33.57716711587028, -112.035743975516 33.5771669661855, -112.035422917633 33.57710769098989, -112.035376564565 33.57710926268129, -112.035271371845 33.57715746120109, -112.035110393746 33.57719600502909, -112.035073832314 33.5772168860472, -112.034984988932 33.57728282213209, -112.03487260969 33.57726635682619, -112.034651803793 33.5772034144232, -112.034581914864 33.5771799887609, -112.034500886826 33.57721209613667, -112.034278104635 33.5771692114573, -112.034176774671 33.57719600502909, -112.034053435983 33.57716711587028, -112.033687641999 33.57719346038861, -112.033461266547 33.5772317796735, -112.033335771902 33.5772731674758, -112.033258606619 33.5773117860944, -112.033139040855 33.57733917835989, -112.032841967991 33.57743385374619, -112.03257391071 33.57749978966539, -112.032441499037 33.5776538145787, -112.032366310048 33.57772027422318, -112.032263902105 33.57782931882178, -112.032058008242 33.57790101725429, -112.031871158663 33.57797555961149, -112.031602742056 33.57803011918759)'), {u'source': u'openstreetmap.org', u'waterway': u'drain', u'intermittent': u'yes', u'oneway': u'yes'}))

        self.assert_has_feature(
            16, 12372, 26272, 'water',
            {'kind': 'drain', 'intermittent': True})

    def test_unnamed_stream(self):
        # Unnamed stream
        self.generate_fixtures(dsl.way(321690441, wkt_loads('LINESTRING (-111.377442904627 33.54759197157559, -111.378109903726 33.54745398968979, -111.378303939827 33.5473899773999, -111.37849689795 33.54728201738369, -111.378657876049 33.54714500829239, -111.378721925929 33.54698201959871, -111.378731897228 33.54682097718357, -111.378698929057 33.54658701219178, -111.378654911609 33.54638801042979, -111.378567864858 33.5461989658184, -111.378339872438 33.5458300094409, -111.378317863714 33.5456859602978, -111.378316875567 33.54547797207809, -111.378369876169 33.54530696914959, -111.378551874845 33.54504499859528, -111.378787862271 33.5448820059406, -111.378862871597 33.54477299460438, -111.378883892174 33.54465597198, -111.378829903426 33.54453902406769, -111.378699917204 33.5444580139615, -111.378440932908 33.54434196423139, -111.378408863052 33.54428798233619, -111.378450904207 33.54416998573199, -111.378514864256 33.54403499322648, -111.378611882306 33.54397898961828, -111.37889188718 33.54397898961828, -111.379074874004 33.5438889944392, -111.379170903908 33.54375295329579, -111.379202883932 33.54358202182527, -111.379233875809 33.5433199711702, -111.379264867686 33.54312096188479, -111.379295859564 33.54274098614861, -111.379295859564 33.5426429783429, -111.379229923222 33.54249001406639, -111.379121945725 33.54234595935588, -111.378970938925 33.5422919762139, -111.378808882848 33.54228396484319, -111.378668925327 33.54226502206649, -111.378625896025 33.5421849831739, -111.378635867324 33.54200498898558, -111.37867790848 33.54176097796277, -111.378676920333 33.54153598406509, -111.378664882908 33.5413279858575, -111.378642874184 33.541201973741, -111.378555917264 33.54104900691419, -111.378458899214 33.54091400953369, -111.378414881765 33.54081495142159, -111.378403922318 33.54068901343109, -111.378531932246 33.5403910143636, -111.378659942174 33.5402360244927)'), {u'source': u'openstreetmap.org', u'waterway': u'stream', u'intermittent': u'yes'}))

        self.assert_has_feature(
            16, 12492, 26279, 'water',
            {'kind': 'stream', 'intermittent': True})

    def test_unnamed_water(self):
        # Unnamed water (lake)
        self.generate_fixtures(dsl.way(68709904, wkt_loads('POLYGON ((-112.164519986777 33.64293627767198, -112.164483066019 33.6430021635084, -112.164226776668 33.64323691410918, -112.164175932023 33.64324065336177, -112.164094364996 33.64322592070568, -112.163999592733 33.64318179750759, -112.163969948329 33.64312152069537, -112.163918025705 33.6428825817999, -112.163860443696 33.64266839626079, -112.163849304586 33.6426102130858, -112.163872840447 33.6425814206261, -112.163894669508 33.6425436538786, -112.16391182733 33.6425191241803, -112.163966444899 33.64250738282831, -112.16402411674 33.6424904812615, -112.164067774863 33.64248135740549, -112.164128590808 33.64246841947689, -112.1642268665 33.642461913119, -112.164350115357 33.64248786376198, -112.164381286897 33.64252039553678, -112.164395300616 33.64254761751829, -112.164387485273 33.64259046968589, -112.164354696765 33.64269157977709, -112.164378861446 33.64275948500839, -112.164449828354 33.64281789243869, -112.164487018606 33.64287891731708, -112.164519986777 33.64293627767198))'), {u'natural': u'water', u'gnis:fcode': u'39001', u'intermittent': u'yes', u'way_area': u'5344.57', u'source': u'openstreetmap.org', u'nhd:reach_code': u'15070102007801', u'nhd:fdate': u'Mon Oct 17 00:00:00 PDT 2005', u'nhd:com_id': u'141293264'}))

        self.assert_has_feature(
            16, 12349, 26257, 'water',
            {'kind': 'water', 'intermittent': True})
