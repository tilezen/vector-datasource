# -*- encoding: utf-8 -*-
import dsl
from shapely.wkt import loads as wkt_loads

from . import FixtureTest


class PowerLines(FixtureTest):

    def test_power_line(self):
        self.generate_fixtures(dsl.way(267300766, wkt_loads('POINT (-122.403392729347 37.65181068477408)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068325, wkt_loads('POINT (-122.410771670754 37.70201656378291)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068326, wkt_loads('POINT (-122.408188205828 37.70321857250548)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068327, wkt_loads('POINT (-122.40885772021 37.70352418892839)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068328, wkt_loads('POINT (-122.409381258357 37.70239688452111)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068367, wkt_loads('POINT (-122.412067760046 37.69906931398108)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068368, wkt_loads('POINT (-122.4129261003 37.69680097626918)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068369, wkt_loads('POINT (-122.412728740432 37.6959316641628)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068370, wkt_loads('POINT (-122.412411096147 37.6945123107651)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068371, wkt_loads('POINT (-122.411964813114 37.69263771044239)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068372, wkt_loads('POINT (-122.411621477013 37.69118431523881)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068373, wkt_loads('POINT (-122.410831768046 37.68771349567169)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068374, wkt_loads('POINT (-122.410325387721 37.68550601968249)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068375, wkt_loads('POINT (-122.409990675446 37.6840387639314)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068376, wkt_loads('POINT (-122.409655873339 37.68279577889188)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068377, wkt_loads('POINT (-122.409192432484 37.68070361542518)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068378, wkt_loads('POINT (-122.408359873879 37.67713042096589)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068379, wkt_loads('POINT (-122.407879185371 37.6750856641076)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068380, wkt_loads('POINT (-122.407638886032 37.67384238684988)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068381, wkt_loads('POINT (-122.407003777126 37.67051346382819)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068382, wkt_loads('POINT (-122.406591809737 37.66848217717578)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068383, wkt_loads('POINT (-122.405836506246 37.6645958630621)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068384, wkt_loads('POINT (-122.405561801432 37.66312826488068)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068617, wkt_loads('POINT (-122.405038173453 37.66057351669139)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068619, wkt_loads('POINT (-122.402875299743 37.6591941650178)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068625, wkt_loads('POINT (-122.40193117038 37.65832441215637)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068627, wkt_loads('POINT (-122.400128700762 37.65670719945599)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068628, wkt_loads('POINT (-122.400103008945 37.6551986937111)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(442068630, wkt_loads('POINT (-122.401819599622 37.65380558693218)'), {u'source': u'openstreetmap.org', u'power': u'tower'}),dsl.way(29399873, wkt_loads('LINESTRING (-122.408188205828 37.70321857250548, -122.40885772021 37.70352418892839, -122.409381258357 37.70239688452111, -122.410771670754 37.70201656378291, -122.412067760046 37.69906931398108, -122.4129261003 37.69680097626918, -122.412728740432 37.6959316641628, -122.412411096147 37.6945123107651, -122.411964813114 37.69263771044239, -122.411621477013 37.69118431523881, -122.410831768046 37.68771349567169, -122.410325387721 37.68550601968249, -122.409990675446 37.6840387639314, -122.409655873339 37.68279577889188, -122.409192432484 37.68070361542518, -122.408359873879 37.67713042096589, -122.407879185371 37.6750856641076, -122.407638886032 37.67384238684988, -122.407003777126 37.67051346382819, -122.406591809737 37.66848217717578, -122.405836506246 37.6645958630621, -122.405561801432 37.66312826488068, -122.405038173453 37.66057351669139, -122.402875299743 37.6591941650178, -122.40193117038 37.65832441215637, -122.400128700762 37.65670719945599, -122.400103008945 37.6551986937111, -122.401819599622 37.65380558693218, -122.403392729347 37.65181068477408)'), {u'source': u'openstreetmap.org', u'wires': u'single', u'cables': u'6', u'created_by': u'Potlatch 0.10f', u'power': u'line'}))

        self.assert_has_feature(
            14, 2621, 6338, 'landuse',
            {'id': 29399873, 'kind': 'power_line', 'min_zoom': 14,
             'sort_rank': 274})

    def test_power_line2(self):
        self.generate_fixtures(dsl.way(4421231698, wkt_loads('POINT (-122.402439257504 37.75446525999031)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231699, wkt_loads('POINT (-122.402020912077 37.75450027509339)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231700, wkt_loads('POINT (-122.40175132766 37.75451405385149)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231702, wkt_loads('POINT (-122.401247732112 37.75454061701718)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231703, wkt_loads('POINT (-122.400758868934 37.75456931090729)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231704, wkt_loads('POINT (-122.40032606063 37.75459580302859)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231705, wkt_loads('POINT (-122.399943917308 37.75462435484847)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231706, wkt_loads('POINT (-122.399543538186 37.75463657104671)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231707, wkt_loads('POINT (-122.399190769774 37.7546561737791)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231709, wkt_loads('POINT (-122.398852913396 37.754680606163)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(4421231710, wkt_loads('POINT (-122.398554493058 37.75470816360948)'), {u'source': u'openstreetmap.org', u'power': u'pole'}),dsl.way(444660087, wkt_loads('LINESTRING (-122.402439257504 37.75446525999031, -122.402020912077 37.75450027509339, -122.40175132766 37.75451405385149, -122.401247732112 37.75454061701718, -122.400758868934 37.75456931090729, -122.40032606063 37.75459580302859, -122.399943917308 37.75462435484847, -122.399543538186 37.75463657104671, -122.399190769774 37.7546561737791, -122.398852913396 37.754680606163, -122.398554493058 37.75470816360948)'), {u'source': u'openstreetmap.org', u'power': u'minor_line'}))

        self.assert_has_feature(
            16, 10485, 25335, 'landuse',
            {'id': 444660087, 'kind': 'power_minor_line', 'min_zoom': 17,
             'sort_rank': 273})
