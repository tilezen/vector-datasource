# -*- encoding: utf-8 -*-
import dsl
from shapely.wkt import loads as wkt_loads

from . import FixtureTest


class PedestrianPathsBicycle(FixtureTest):
    def test_path(self):
        # Add footway properties to pedestrian paths and piers
        # Pedestrian path
        self.generate_fixtures(dsl.way(65350161, wkt_loads('POINT (-122.468911803752 37.79462847436059)'), {u'source': u'openstreetmap.org', u'barrier': u'gate'}),dsl.way(65350219, wkt_loads('POINT (-122.471386123371 37.79010659916251)'), {u'source': u'openstreetmap.org', u'barrier': u'gate', u'hazard': u'golf balls'}),dsl.way(8919991, wkt_loads('LINESTRING (-122.469171776195 37.79497261365739, -122.46906802078 37.7948439165379, -122.469001365786 37.79474801467759, -122.468958066989 37.79468398538688, -122.468911803752 37.79462847436059, -122.468704113258 37.79440039601008, -122.468489505737 37.7941686966474, -122.468455100262 37.79412986705689, -122.468428420298 37.79408450668669, -122.468412340454 37.79403779754408, -122.468406770899 37.79398739706817, -122.468414316748 37.79393678359808, -122.468431115243 37.79388531825269, -122.468465071561 37.79383626642129, -122.468677433294 37.7936109541171, -122.468757922344 37.79352115554348, -122.468839309709 37.79343405437218, -122.46917438131 37.79308671347228, -122.46922612427 37.7930371641979, -122.469282358807 37.792989815505, -122.469335089914 37.79295055936928, -122.469391144788 37.79291605938468, -122.469741308085 37.79272006225289, -122.469793859529 37.79268712389349, -122.469839943104 37.79264701574219, -122.469878840155 37.79259916988369, -122.469909293043 37.79254237950688, -122.469934805197 37.7924757927345, -122.469972714102 37.79236675499051, -122.470007928062 37.79228355681199, -122.470051406521 37.79220071348139, -122.470108000384 37.792098916151, -122.470572339555 37.791300859975, -122.470824496655 37.79089451672799, -122.470877407425 37.79081770596098, -122.470931126679 37.79074508350789, -122.470986013743 37.79066585893229, -122.471046919519 37.79057399807259, -122.471108364285 37.79048199511859, -122.47116334118 37.7904051129327, -122.471219665548 37.79032780472599, -122.471386123371 37.79010659916251, -122.471436339195 37.79004696725409, -122.471609534382 37.7898362674592, -122.471664062119 37.78976371503218, -122.471708528726 37.789693860182, -122.47174401218 37.78963387298659, -122.471779675297 37.78956699962968, -122.47180806206 37.78950225593989, -122.471832675898 37.78943055507678, -122.471848486247 37.78936346856278, -122.471858996536 37.78929219351179, -122.471922237932 37.78884551602918, -122.47193328721 37.78878162360659, -122.471949816211 37.78871190981137, -122.471970746957 37.78864787528969, -122.472000660856 37.7885751797124, -122.472330162903 37.78794519570759, -122.472361244611 37.78789010557308, -122.47240112981 37.78783345356199, -122.47245341176 37.78777807937389, -122.472605406706 37.78764241243758, -122.472657598824 37.7875912976717, -122.472740603156 37.78753535535969, -122.47280195809 37.78749957497539, -122.472853790882 37.7874770702408, -122.473022404661 37.78742517443849, -122.473087981676 37.7874003979072, -122.473163170666 37.78736440447868, -122.473209164408 37.78734601729639, -122.473256775118 37.78733465841699, -122.473303577344 37.78732869500469, -122.473360800028 37.78732528734018)'), {u'tiger:name_base': u'Park', u'maxspeed': u'15 mph', u'bicycle': u'designated', u'name': u'Park Boulevard Trail', u'tiger:cfcc': u'A41', u'tiger:reviewed': u'no', u'source': u'openstreetmap.org', u'tiger:county': u'San Francisco, CA', u'tiger:name_type': u'Blvd', u'motorcar': u'designated', u'foot': u'designated', u'highway': u'pedestrian'}))

        self.assert_has_feature(
            13, 1309, 3165, 'roads',
            {'id': 8919991, 'kind': 'path', 'is_bicycle_related': True,
             'bicycle': 'designated'})

    def test_pier(self):
        # Pier
        self.generate_fixtures(dsl.way(133920164, wkt_loads('LINESTRING (-122.691139823515 45.41466291167389, -122.691135331938 45.414541018281, -122.690944529772 45.414546693613)'), {u'bicycle': u'yes', u'RLIS:systemname': u'Village on the Lake Marina Association Trails', u'man_made': u'pier', u'surface': u'paved', u'access': u'private', u'source': u'openstreetmap.org', u'est_width': u'0.9'}))

        self.assert_has_feature(
            13, 1304, 2933, 'roads',
            {'id': 133920164, 'kind': 'path', 'is_bicycle_related': True,
             'bicycle': 'yes'})
